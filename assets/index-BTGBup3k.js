(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function Ce(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Pa(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function $i(t){let e,n,r;t.length!==2?(e=Ce,n=(o,c)=>Ce(t(o),c),r=(o,c)=>t(o)-c):(e=t===Ce||t===Pa?t:qa,n=t,r=t);function i(o,c,l=0,f=o.length){if(l<f){if(e(c,c)!==0)return f;do{const d=l+f>>>1;n(o[d],c)<0?l=d+1:f=d}while(l<f)}return l}function a(o,c,l=0,f=o.length){if(l<f){if(e(c,c)!==0)return f;do{const d=l+f>>>1;n(o[d],c)<=0?l=d+1:f=d}while(l<f)}return l}function s(o,c,l=0,f=o.length){const d=i(o,c,l,f-1);return d>l&&r(o[d-1],c)>-r(o[d],c)?d-1:d}return{left:i,center:s,right:a}}function qa(){return 0}function Ga(t){return t===null?NaN:+t}const Wa=$i(Ce),Za=Wa.right;$i(Ga).center;const Xa=Math.sqrt(50),Ya=Math.sqrt(10),Ka=Math.sqrt(2);function We(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),s=a>=Xa?10:a>=Ya?5:a>=Ka?2:1;let o,c,l;return i<0?(l=Math.pow(10,-i)/s,o=Math.round(t*l),c=Math.round(e*l),o/l<t&&++o,c/l>e&&--c,l=-l):(l=Math.pow(10,i)*s,o=Math.round(t/l),c=Math.round(e/l),o*l<t&&++o,c*l>e&&--c),c<o&&.5<=n&&n<2?We(t,e,n*2):[o,c,l]}function Ja(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,a,s]=r?We(e,t,n):We(t,e,n);if(!(a>=i))return[];const o=a-i+1,c=new Array(o);if(r)if(s<0)for(let l=0;l<o;++l)c[l]=(a-l)/-s;else for(let l=0;l<o;++l)c[l]=(a-l)*s;else if(s<0)for(let l=0;l<o;++l)c[l]=(i+l)/-s;else for(let l=0;l<o;++l)c[l]=(i+l)*s;return c}function Rn(t,e,n){return e=+e,t=+t,n=+n,We(t,e,n)[2]}function Qa(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Rn(e,t,n):Rn(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function ja(t){return t}var He=1,mn=2,Sn=3,Re=4,gr=1e-6;function ts(t){return"translate("+t+",0)"}function es(t){return"translate(0,"+t+")"}function ns(t){return e=>+t(e)}function rs(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function is(){return!this.__axis}function Ai(t,e){var n=[],r=null,i=null,a=6,s=6,o=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,l=t===He||t===Re?-1:1,f=t===Re||t===mn?"x":"y",d=t===He||t===Sn?ts:es;function h(u){var w=r??(e.ticks?e.ticks.apply(e,n):e.domain()),T=i??(e.tickFormat?e.tickFormat.apply(e,n):ja),k=Math.max(a,0)+o,$=e.range(),g=+$[0]+c,_=+$[$.length-1]+c,m=(e.bandwidth?rs:ns)(e.copy(),c),x=u.selection?u.selection():u,A=x.selectAll(".domain").data([null]),y=x.selectAll(".tick").data(w,e).order(),E=y.exit(),b=y.enter().append("g").attr("class","tick"),v=y.select("line"),p=y.select("text");A=A.merge(A.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),y=y.merge(b),v=v.merge(b.append("line").attr("stroke","currentColor").attr(f+"2",l*a)),p=p.merge(b.append("text").attr("fill","currentColor").attr(f,l*k).attr("dy",t===He?"0em":t===Sn?"0.71em":"0.32em")),u!==x&&(A=A.transition(u),y=y.transition(u),v=v.transition(u),p=p.transition(u),E=E.transition(u).attr("opacity",gr).attr("transform",function(D){return isFinite(D=m(D))?d(D+c):this.getAttribute("transform")}),b.attr("opacity",gr).attr("transform",function(D){var M=this.parentNode.__axis;return d((M&&isFinite(M=M(D))?M:m(D))+c)})),E.remove(),A.attr("d",t===Re||t===mn?s?"M"+l*s+","+g+"H"+c+"V"+_+"H"+l*s:"M"+c+","+g+"V"+_:s?"M"+g+","+l*s+"V"+c+"H"+_+"V"+l*s:"M"+g+","+c+"H"+_),y.attr("opacity",1).attr("transform",function(D){return d(m(D)+c)}),v.attr(f+"2",l*a),p.attr(f,l*k).text(T),x.filter(is).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===mn?"start":t===Re?"end":"middle"),x.each(function(){this.__axis=m})}return h.scale=function(u){return arguments.length?(e=u,h):e},h.ticks=function(){return n=Array.from(arguments),h},h.tickArguments=function(u){return arguments.length?(n=u==null?[]:Array.from(u),h):n.slice()},h.tickValues=function(u){return arguments.length?(r=u==null?null:Array.from(u),h):r&&r.slice()},h.tickFormat=function(u){return arguments.length?(i=u,h):i},h.tickSize=function(u){return arguments.length?(a=s=+u,h):a},h.tickSizeInner=function(u){return arguments.length?(a=+u,h):a},h.tickSizeOuter=function(u){return arguments.length?(s=+u,h):s},h.tickPadding=function(u){return arguments.length?(o=+u,h):o},h.offset=function(u){return arguments.length?(c=+u,h):c},h}function _r(t){return Ai(He,t)}function as(t){return Ai(Sn,t)}var ss={value:()=>{}};function Ei(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ze(n)}function ze(t){this._=t}function os(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ze.prototype=Ei.prototype={constructor:ze,on:function(t,e){var n=this._,r=os(t+"",n),i,a=-1,s=r.length;if(arguments.length<2){for(;++a<s;)if((i=(t=r[a]).type)&&(i=ls(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(t=r[a]).type)n[i]=wr(n[i],t.name,e);else if(e==null)for(i in n)n[i]=wr(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new ze(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};function ls(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function wr(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=ss,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Nn="http://www.w3.org/1999/xhtml";const yr={svg:"http://www.w3.org/2000/svg",xhtml:Nn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ln(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),yr.hasOwnProperty(e)?{space:yr[e],local:t}:t}function cs(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Nn&&e.documentElement.namespaceURI===Nn?e.createElement(t):e.createElementNS(n,t)}}function fs(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ti(t){var e=ln(t);return(e.local?fs:cs)(e)}function us(){}function Jn(t){return t==null?us:function(){return this.querySelector(t)}}function hs(t){typeof t!="function"&&(t=Jn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,o=r[i]=new Array(s),c,l,f=0;f<s;++f)(c=a[f])&&(l=t.call(c,c.__data__,f,a))&&("__data__"in c&&(l.__data__=c.__data__),o[f]=l);return new yt(r,this._parents)}function Ri(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ds(){return[]}function Si(t){return t==null?ds:function(){return this.querySelectorAll(t)}}function ps(t){return function(){return Ri(t.apply(this,arguments))}}function ms(t){typeof t=="function"?t=ps(t):t=Si(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var s=e[a],o=s.length,c,l=0;l<o;++l)(c=s[l])&&(r.push(t.call(c,c.__data__,l,s)),i.push(c));return new yt(r,i)}function Ni(t){return function(){return this.matches(t)}}function Mi(t){return function(e){return e.matches(t)}}var gs=Array.prototype.find;function _s(t){return function(){return gs.call(this.children,t)}}function ws(){return this.firstElementChild}function ys(t){return this.select(t==null?ws:_s(typeof t=="function"?t:Mi(t)))}var xs=Array.prototype.filter;function vs(){return Array.from(this.children)}function bs(t){return function(){return xs.call(this.children,t)}}function ks(t){return this.selectAll(t==null?vs:bs(typeof t=="function"?t:Mi(t)))}function $s(t){typeof t!="function"&&(t=Ni(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,o=r[i]=[],c,l=0;l<s;++l)(c=a[l])&&t.call(c,c.__data__,l,a)&&o.push(c);return new yt(r,this._parents)}function Ii(t){return new Array(t.length)}function As(){return new yt(this._enter||this._groups.map(Ii),this._parents)}function Ze(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ze.prototype={constructor:Ze,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Es(t){return function(){return t}}function Ts(t,e,n,r,i,a){for(var s=0,o,c=e.length,l=a.length;s<l;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new Ze(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function Rs(t,e,n,r,i,a,s){var o,c,l=new Map,f=e.length,d=a.length,h=new Array(f),u;for(o=0;o<f;++o)(c=e[o])&&(h[o]=u=s.call(c,c.__data__,o,e)+"",l.has(u)?i[o]=c:l.set(u,c));for(o=0;o<d;++o)u=s.call(t,a[o],o,a)+"",(c=l.get(u))?(r[o]=c,c.__data__=a[o],l.delete(u)):n[o]=new Ze(t,a[o]);for(o=0;o<f;++o)(c=e[o])&&l.get(h[o])===c&&(i[o]=c)}function Ss(t){return t.__data__}function Ns(t,e){if(!arguments.length)return Array.from(this,Ss);var n=e?Rs:Ts,r=this._parents,i=this._groups;typeof t!="function"&&(t=Es(t));for(var a=i.length,s=new Array(a),o=new Array(a),c=new Array(a),l=0;l<a;++l){var f=r[l],d=i[l],h=d.length,u=Ms(t.call(f,f&&f.__data__,l,r)),w=u.length,T=o[l]=new Array(w),k=s[l]=new Array(w),$=c[l]=new Array(h);n(f,d,T,k,$,u,e);for(var g=0,_=0,m,x;g<w;++g)if(m=T[g]){for(g>=_&&(_=g+1);!(x=k[_])&&++_<w;);m._next=x||null}}return s=new yt(s,r),s._enter=o,s._exit=c,s}function Ms(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Is(){return new yt(this._exit||this._groups.map(Ii),this._parents)}function Ds(t,e,n){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Os(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,s=Math.min(i,a),o=new Array(i),c=0;c<s;++c)for(var l=n[c],f=r[c],d=l.length,h=o[c]=new Array(d),u,w=0;w<d;++w)(u=l[w]||f[w])&&(h[w]=u);for(;c<i;++c)o[c]=n[c];return new yt(o,this._parents)}function Ls(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],s;--i>=0;)(s=r[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function Fs(t){t||(t=Vs);function e(d,h){return d&&h?t(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var s=n[a],o=s.length,c=i[a]=new Array(o),l,f=0;f<o;++f)(l=s[f])&&(c[f]=l);c.sort(e)}return new yt(i,this._parents).order()}function Vs(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Bs(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Cs(){return Array.from(this)}function Hs(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null}function zs(){let t=0;for(const e of this)++t;return t}function Us(){return!this.node()}function Ps(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,s=i.length,o;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this}function qs(t){return function(){this.removeAttribute(t)}}function Gs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ws(t,e){return function(){this.setAttribute(t,e)}}function Zs(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Xs(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Ys(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Ks(t,e){var n=ln(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Gs:qs:typeof e=="function"?n.local?Ys:Xs:n.local?Zs:Ws)(n,e))}function Di(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Js(t){return function(){this.style.removeProperty(t)}}function Qs(t,e,n){return function(){this.style.setProperty(t,e,n)}}function js(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function to(t,e,n){return arguments.length>1?this.each((e==null?Js:typeof e=="function"?js:Qs)(t,e,n??"")):oe(this.node(),t)}function oe(t,e){return t.style.getPropertyValue(e)||Di(t).getComputedStyle(t,null).getPropertyValue(e)}function eo(t){return function(){delete this[t]}}function no(t,e){return function(){this[t]=e}}function ro(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function io(t,e){return arguments.length>1?this.each((e==null?eo:typeof e=="function"?ro:no)(t,e)):this.node()[t]}function Oi(t){return t.trim().split(/^|\s+/)}function Qn(t){return t.classList||new Li(t)}function Li(t){this._node=t,this._names=Oi(t.getAttribute("class")||"")}Li.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Fi(t,e){for(var n=Qn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Vi(t,e){for(var n=Qn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function ao(t){return function(){Fi(this,t)}}function so(t){return function(){Vi(this,t)}}function oo(t,e){return function(){(e.apply(this,arguments)?Fi:Vi)(this,t)}}function lo(t,e){var n=Oi(t+"");if(arguments.length<2){for(var r=Qn(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?oo:e?ao:so)(n,e))}function co(){this.textContent=""}function fo(t){return function(){this.textContent=t}}function uo(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ho(t){return arguments.length?this.each(t==null?co:(typeof t=="function"?uo:fo)(t)):this.node().textContent}function po(){this.innerHTML=""}function mo(t){return function(){this.innerHTML=t}}function go(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function _o(t){return arguments.length?this.each(t==null?po:(typeof t=="function"?go:mo)(t)):this.node().innerHTML}function wo(){this.nextSibling&&this.parentNode.appendChild(this)}function yo(){return this.each(wo)}function xo(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function vo(){return this.each(xo)}function bo(t){var e=typeof t=="function"?t:Ti(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function ko(){return null}function $o(t,e){var n=typeof t=="function"?t:Ti(t),r=e==null?ko:typeof e=="function"?e:Jn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ao(){var t=this.parentNode;t&&t.removeChild(this)}function Eo(){return this.each(Ao)}function To(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ro(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function So(t){return this.select(t?Ro:To)}function No(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Mo(t){return function(e){t.call(this,e,this.__data__)}}function Io(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Do(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function Oo(t,e,n){return function(){var r=this.__on,i,a=Mo(e);if(r){for(var s=0,o=r.length;s<o;++s)if((i=r[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Lo(t,e,n){var r=Io(t+""),i,a=r.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,l=o.length,f;c<l;++c)for(i=0,f=o[c];i<a;++i)if((s=r[i]).type===f.type&&s.name===f.name)return f.value}return}for(o=e?Oo:Do,i=0;i<a;++i)this.each(o(r[i],e,n));return this}function Bi(t,e,n){var r=Di(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Fo(t,e){return function(){return Bi(this,t,e)}}function Vo(t,e){return function(){return Bi(this,t,e.apply(this,arguments))}}function Bo(t,e){return this.each((typeof e=="function"?Vo:Fo)(t,e))}function*Co(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length,s;i<a;++i)(s=r[i])&&(yield s)}var jn=[null];function yt(t,e){this._groups=t,this._parents=e}function ee(){return new yt([[document.documentElement]],jn)}function Ho(){return this}yt.prototype=ee.prototype={constructor:yt,select:hs,selectAll:ms,selectChild:ys,selectChildren:ks,filter:$s,data:Ns,enter:As,exit:Is,join:Ds,merge:Os,selection:Ho,order:Ls,sort:Fs,call:Bs,nodes:Cs,node:Hs,size:zs,empty:Us,each:Ps,attr:Ks,style:to,property:io,classed:lo,text:ho,html:_o,raise:yo,lower:vo,append:bo,insert:$o,remove:Eo,clone:So,datum:No,on:Lo,dispatch:Bo,[Symbol.iterator]:Co};function K(t){return typeof t=="string"?new yt([[document.querySelector(t)]],[document.documentElement]):new yt([[t]],jn)}function St(t){return typeof t=="string"?new yt([document.querySelectorAll(t)],[document.documentElement]):new yt([Ri(t)],jn)}function tr(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ci(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ae(){}var ye=.7,Xe=1/ye,se="\\s*([+-]?\\d+)\\s*",xe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ot="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",zo=/^#([0-9a-f]{3,8})$/,Uo=new RegExp(`^rgb\\(${se},${se},${se}\\)$`),Po=new RegExp(`^rgb\\(${Ot},${Ot},${Ot}\\)$`),qo=new RegExp(`^rgba\\(${se},${se},${se},${xe}\\)$`),Go=new RegExp(`^rgba\\(${Ot},${Ot},${Ot},${xe}\\)$`),Wo=new RegExp(`^hsl\\(${xe},${Ot},${Ot}\\)$`),Zo=new RegExp(`^hsla\\(${xe},${Ot},${Ot},${xe}\\)$`),xr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};tr(Ae,Qt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:vr,formatHex:vr,formatHex8:Xo,formatHsl:Yo,formatRgb:br,toString:br});function vr(){return this.rgb().formatHex()}function Xo(){return this.rgb().formatHex8()}function Yo(){return Hi(this).formatHsl()}function br(){return this.rgb().formatRgb()}function Qt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=zo.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?kr(e):n===3?new bt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Se(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Se(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Uo.exec(t))?new bt(e[1],e[2],e[3],1):(e=Po.exec(t))?new bt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=qo.exec(t))?Se(e[1],e[2],e[3],e[4]):(e=Go.exec(t))?Se(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Wo.exec(t))?Er(e[1],e[2]/100,e[3]/100,1):(e=Zo.exec(t))?Er(e[1],e[2]/100,e[3]/100,e[4]):xr.hasOwnProperty(t)?kr(xr[t]):t==="transparent"?new bt(NaN,NaN,NaN,0):null}function kr(t){return new bt(t>>16&255,t>>8&255,t&255,1)}function Se(t,e,n,r){return r<=0&&(t=e=n=NaN),new bt(t,e,n,r)}function Ko(t){return t instanceof Ae||(t=Qt(t)),t?(t=t.rgb(),new bt(t.r,t.g,t.b,t.opacity)):new bt}function Mn(t,e,n,r){return arguments.length===1?Ko(t):new bt(t,e,n,r??1)}function bt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}tr(bt,Mn,Ci(Ae,{brighter(t){return t=t==null?Xe:Math.pow(Xe,t),new bt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ye:Math.pow(ye,t),new bt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new bt(Kt(this.r),Kt(this.g),Kt(this.b),Ye(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$r,formatHex:$r,formatHex8:Jo,formatRgb:Ar,toString:Ar}));function $r(){return`#${Yt(this.r)}${Yt(this.g)}${Yt(this.b)}`}function Jo(){return`#${Yt(this.r)}${Yt(this.g)}${Yt(this.b)}${Yt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ar(){const t=Ye(this.opacity);return`${t===1?"rgb(":"rgba("}${Kt(this.r)}, ${Kt(this.g)}, ${Kt(this.b)}${t===1?")":`, ${t})`}`}function Ye(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Kt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Yt(t){return t=Kt(t),(t<16?"0":"")+t.toString(16)}function Er(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Mt(t,e,n,r)}function Hi(t){if(t instanceof Mt)return new Mt(t.h,t.s,t.l,t.opacity);if(t instanceof Ae||(t=Qt(t)),!t)return new Mt;if(t instanceof Mt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),s=NaN,o=a-i,c=(a+i)/2;return o?(e===a?s=(n-r)/o+(n<r)*6:n===a?s=(r-e)/o+2:s=(e-n)/o+4,o/=c<.5?a+i:2-a-i,s*=60):o=c>0&&c<1?0:s,new Mt(s,o,c,t.opacity)}function Qo(t,e,n,r){return arguments.length===1?Hi(t):new Mt(t,e,n,r??1)}function Mt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}tr(Mt,Qo,Ci(Ae,{brighter(t){return t=t==null?Xe:Math.pow(Xe,t),new Mt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ye:Math.pow(ye,t),new Mt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new bt(gn(t>=240?t-240:t+120,i,r),gn(t,i,r),gn(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Mt(Tr(this.h),Ne(this.s),Ne(this.l),Ye(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ye(this.opacity);return`${t===1?"hsl(":"hsla("}${Tr(this.h)}, ${Ne(this.s)*100}%, ${Ne(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Tr(t){return t=(t||0)%360,t<0?t+360:t}function Ne(t){return Math.max(0,Math.min(1,t||0))}function gn(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const er=t=>()=>t;function jo(t,e){return function(n){return t+n*e}}function tl(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function el(t){return(t=+t)==1?zi:function(e,n){return n-e?tl(e,n,t):er(isNaN(e)?n:e)}}function zi(t,e){var n=e-t;return n?jo(t,n):er(isNaN(t)?e:t)}const Ke=function t(e){var n=el(e);function r(i,a){var s=n((i=Mn(i)).r,(a=Mn(a)).r),o=n(i.g,a.g),c=n(i.b,a.b),l=zi(i.opacity,a.opacity);return function(f){return i.r=s(f),i.g=o(f),i.b=c(f),i.opacity=l(f),i+""}}return r.gamma=t,r}(1);function nl(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function rl(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function il(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),s;for(s=0;s<r;++s)i[s]=nr(t[s],e[s]);for(;s<n;++s)a[s]=e[s];return function(o){for(s=0;s<r;++s)a[s]=i[s](o);return a}}function al(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Nt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function sl(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=nr(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var In=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_n=new RegExp(In.source,"g");function ol(t){return function(){return t}}function ll(t){return function(e){return t(e)+""}}function Ui(t,e){var n=In.lastIndex=_n.lastIndex=0,r,i,a,s=-1,o=[],c=[];for(t=t+"",e=e+"";(r=In.exec(t))&&(i=_n.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),o[s]?o[s]+=a:o[++s]=a),(r=r[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,c.push({i:s,x:Nt(r,i)})),n=_n.lastIndex;return n<e.length&&(a=e.slice(n),o[s]?o[s]+=a:o[++s]=a),o.length<2?c[0]?ll(c[0].x):ol(e):(e=c.length,function(l){for(var f=0,d;f<e;++f)o[(d=c[f]).i]=d.x(l);return o.join("")})}function nr(t,e){var n=typeof e,r;return e==null||n==="boolean"?er(e):(n==="number"?Nt:n==="string"?(r=Qt(e))?(e=r,Ke):Ui:e instanceof Qt?Ke:e instanceof Date?al:rl(e)?nl:Array.isArray(e)?il:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?sl:Nt)(t,e)}function cl(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Rr=180/Math.PI,Dn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Pi(t,e,n,r,i,a){var s,o,c;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,c/=o),t*r<e*n&&(t=-t,e=-e,c=-c,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Rr,skewX:Math.atan(c)*Rr,scaleX:s,scaleY:o}}var Me;function fl(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Dn:Pi(e.a,e.b,e.c,e.d,e.e,e.f)}function ul(t){return t==null||(Me||(Me=document.createElementNS("http://www.w3.org/2000/svg","g")),Me.setAttribute("transform",t),!(t=Me.transform.baseVal.consolidate()))?Dn:(t=t.matrix,Pi(t.a,t.b,t.c,t.d,t.e,t.f))}function qi(t,e,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,f,d,h,u,w){if(l!==d||f!==h){var T=u.push("translate(",null,e,null,n);w.push({i:T-4,x:Nt(l,d)},{i:T-2,x:Nt(f,h)})}else(d||h)&&u.push("translate("+d+e+h+n)}function s(l,f,d,h){l!==f?(l-f>180?f+=360:f-l>180&&(l+=360),h.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Nt(l,f)})):f&&d.push(i(d)+"rotate("+f+r)}function o(l,f,d,h){l!==f?h.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Nt(l,f)}):f&&d.push(i(d)+"skewX("+f+r)}function c(l,f,d,h,u,w){if(l!==d||f!==h){var T=u.push(i(u)+"scale(",null,",",null,")");w.push({i:T-4,x:Nt(l,d)},{i:T-2,x:Nt(f,h)})}else(d!==1||h!==1)&&u.push(i(u)+"scale("+d+","+h+")")}return function(l,f){var d=[],h=[];return l=t(l),f=t(f),a(l.translateX,l.translateY,f.translateX,f.translateY,d,h),s(l.rotate,f.rotate,d,h),o(l.skewX,f.skewX,d,h),c(l.scaleX,l.scaleY,f.scaleX,f.scaleY,d,h),l=f=null,function(u){for(var w=-1,T=h.length,k;++w<T;)d[(k=h[w]).i]=k.x(u);return d.join("")}}}var hl=qi(fl,"px, ","px)","deg)"),dl=qi(ul,", ",")",")"),le=0,me=0,pe=0,Gi=1e3,Je,ge,Qe=0,jt=0,cn=0,ve=typeof performance=="object"&&performance.now?performance:Date,Wi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function rr(){return jt||(Wi(pl),jt=ve.now()+cn)}function pl(){jt=0}function je(){this._call=this._time=this._next=null}je.prototype=Zi.prototype={constructor:je,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?rr():+n)+(e==null?0:+e),!this._next&&ge!==this&&(ge?ge._next=this:Je=this,ge=this),this._call=t,this._time=n,On()},stop:function(){this._call&&(this._call=null,this._time=1/0,On())}};function Zi(t,e,n){var r=new je;return r.restart(t,e,n),r}function ml(){rr(),++le;for(var t=Je,e;t;)(e=jt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--le}function Sr(){jt=(Qe=ve.now())+cn,le=me=0;try{ml()}finally{le=0,_l(),jt=0}}function gl(){var t=ve.now(),e=t-Qe;e>Gi&&(cn-=e,Qe=t)}function _l(){for(var t,e=Je,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Je=n);ge=t,On(r)}function On(t){if(!le){me&&(me=clearTimeout(me));var e=t-jt;e>24?(t<1/0&&(me=setTimeout(Sr,t-ve.now()-cn)),pe&&(pe=clearInterval(pe))):(pe||(Qe=ve.now(),pe=setInterval(gl,Gi)),le=1,Wi(Sr))}}function Nr(t,e,n){var r=new je;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var wl=Ei("start","end","cancel","interrupt"),yl=[],Xi=0,Mr=1,Ln=2,Ue=3,Ir=4,Fn=5,Pe=6;function fn(t,e,n,r,i,a){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;xl(t,n,{name:e,index:r,group:i,on:wl,tween:yl,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Xi})}function ir(t,e){var n=It(t,e);if(n.state>Xi)throw new Error("too late; already scheduled");return n}function Lt(t,e){var n=It(t,e);if(n.state>Ue)throw new Error("too late; already running");return n}function It(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function xl(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Zi(a,0,n.time);function a(l){n.state=Mr,n.timer.restart(s,n.delay,n.time),n.delay<=l&&s(l-n.delay)}function s(l){var f,d,h,u;if(n.state!==Mr)return c();for(f in r)if(u=r[f],u.name===n.name){if(u.state===Ue)return Nr(s);u.state===Ir?(u.state=Pe,u.timer.stop(),u.on.call("interrupt",t,t.__data__,u.index,u.group),delete r[f]):+f<e&&(u.state=Pe,u.timer.stop(),u.on.call("cancel",t,t.__data__,u.index,u.group),delete r[f])}if(Nr(function(){n.state===Ue&&(n.state=Ir,n.timer.restart(o,n.delay,n.time),o(l))}),n.state=Ln,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Ln){for(n.state=Ue,i=new Array(h=n.tween.length),f=0,d=-1;f<h;++f)(u=n.tween[f].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=u);i.length=d+1}}function o(l){for(var f=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=Fn,1),d=-1,h=i.length;++d<h;)i[d].call(t,f);n.state===Fn&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=Pe,n.timer.stop(),delete r[e];for(var l in r)return;delete t.__transition}}function vl(t,e){var n=t.__transition,r,i,a=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){a=!1;continue}i=r.state>Ln&&r.state<Fn,r.state=Pe,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}a&&delete t.__transition}}function bl(t){return this.each(function(){vl(this,t)})}function kl(t,e){var n,r;return function(){var i=Lt(this,t),a=i.tween;if(a!==n){r=n=a;for(var s=0,o=r.length;s<o;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function $l(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=Lt(this,t),s=a.tween;if(s!==r){i=(r=s).slice();for(var o={name:e,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===e){i[c]=o;break}c===l&&i.push(o)}a.tween=i}}function Al(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=It(this.node(),n).tween,i=0,a=r.length,s;i<a;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((e==null?kl:$l)(n,t,e))}function ar(t,e,n){var r=t._id;return t.each(function(){var i=Lt(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return It(i,r).value[e]}}function Yi(t,e){var n;return(typeof e=="number"?Nt:e instanceof Qt?Ke:(n=Qt(e))?(e=n,Ke):Ui)(t,e)}function El(t){return function(){this.removeAttribute(t)}}function Tl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Rl(t,e,n){var r,i=n+"",a;return function(){var s=this.getAttribute(t);return s===i?null:s===r?a:a=e(r=s,n)}}function Sl(t,e,n){var r,i=n+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?a:a=e(r=s,n)}}function Nl(t,e,n){var r,i,a;return function(){var s,o=n(this),c;return o==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=o+"",s===c?null:s===r&&c===i?a:(i=c,a=e(r=s,o)))}}function Ml(t,e,n){var r,i,a;return function(){var s,o=n(this),c;return o==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=o+"",s===c?null:s===r&&c===i?a:(i=c,a=e(r=s,o)))}}function Il(t,e){var n=ln(t),r=n==="transform"?dl:Yi;return this.attrTween(t,typeof e=="function"?(n.local?Ml:Nl)(n,r,ar(this,"attr."+t,e)):e==null?(n.local?Tl:El)(n):(n.local?Sl:Rl)(n,r,e))}function Dl(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ol(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ll(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Ol(t,a)),n}return i._value=e,i}function Fl(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Dl(t,a)),n}return i._value=e,i}function Vl(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=ln(t);return this.tween(n,(r.local?Ll:Fl)(r,e))}function Bl(t,e){return function(){ir(this,t).delay=+e.apply(this,arguments)}}function Cl(t,e){return e=+e,function(){ir(this,t).delay=e}}function Hl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Bl:Cl)(e,t)):It(this.node(),e).delay}function zl(t,e){return function(){Lt(this,t).duration=+e.apply(this,arguments)}}function Ul(t,e){return e=+e,function(){Lt(this,t).duration=e}}function Pl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?zl:Ul)(e,t)):It(this.node(),e).duration}function ql(t,e){if(typeof e!="function")throw new Error;return function(){Lt(this,t).ease=e}}function Gl(t){var e=this._id;return arguments.length?this.each(ql(e,t)):It(this.node(),e).ease}function Wl(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Lt(this,t).ease=n}}function Zl(t){if(typeof t!="function")throw new Error;return this.each(Wl(this._id,t))}function Xl(t){typeof t!="function"&&(t=Ni(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,o=r[i]=[],c,l=0;l<s;++l)(c=a[l])&&t.call(c,c.__data__,l,a)&&o.push(c);return new Ht(r,this._parents,this._name,this._id)}function Yl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),s=new Array(r),o=0;o<a;++o)for(var c=e[o],l=n[o],f=c.length,d=s[o]=new Array(f),h,u=0;u<f;++u)(h=c[u]||l[u])&&(d[u]=h);for(;o<r;++o)s[o]=e[o];return new Ht(s,this._parents,this._name,this._id)}function Kl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Jl(t,e,n){var r,i,a=Kl(e)?ir:Lt;return function(){var s=a(this,t),o=s.on;o!==r&&(i=(r=o).copy()).on(e,n),s.on=i}}function Ql(t,e){var n=this._id;return arguments.length<2?It(this.node(),n).on.on(t):this.each(Jl(n,t,e))}function jl(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function tc(){return this.on("end.remove",jl(this._id))}function ec(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Jn(t));for(var r=this._groups,i=r.length,a=new Array(i),s=0;s<i;++s)for(var o=r[s],c=o.length,l=a[s]=new Array(c),f,d,h=0;h<c;++h)(f=o[h])&&(d=t.call(f,f.__data__,h,o))&&("__data__"in f&&(d.__data__=f.__data__),l[h]=d,fn(l[h],e,n,h,l,It(f,n)));return new Ht(a,this._parents,e,n)}function nc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Si(t));for(var r=this._groups,i=r.length,a=[],s=[],o=0;o<i;++o)for(var c=r[o],l=c.length,f,d=0;d<l;++d)if(f=c[d]){for(var h=t.call(f,f.__data__,d,c),u,w=It(f,n),T=0,k=h.length;T<k;++T)(u=h[T])&&fn(u,e,n,T,h,w);a.push(h),s.push(f)}return new Ht(a,s,e,n)}var rc=ee.prototype.constructor;function ic(){return new rc(this._groups,this._parents)}function ac(t,e){var n,r,i;return function(){var a=oe(this,t),s=(this.style.removeProperty(t),oe(this,t));return a===s?null:a===n&&s===r?i:i=e(n=a,r=s)}}function Ki(t){return function(){this.style.removeProperty(t)}}function sc(t,e,n){var r,i=n+"",a;return function(){var s=oe(this,t);return s===i?null:s===r?a:a=e(r=s,n)}}function oc(t,e,n){var r,i,a;return function(){var s=oe(this,t),o=n(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(t),oe(this,t))),s===c?null:s===r&&c===i?a:(i=c,a=e(r=s,o))}}function lc(t,e){var n,r,i,a="style."+e,s="end."+a,o;return function(){var c=Lt(this,t),l=c.on,f=c.value[a]==null?o||(o=Ki(e)):void 0;(l!==n||i!==f)&&(r=(n=l).copy()).on(s,i=f),c.on=r}}function cc(t,e,n){var r=(t+="")=="transform"?hl:Yi;return e==null?this.styleTween(t,ac(t,r)).on("end.style."+t,Ki(t)):typeof e=="function"?this.styleTween(t,oc(t,r,ar(this,"style."+t,e))).each(lc(this._id,t)):this.styleTween(t,sc(t,r,e),n).on("end.style."+t,null)}function fc(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function uc(t,e,n){var r,i;function a(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&fc(t,s,n)),r}return a._value=e,a}function hc(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,uc(t,e,n??""))}function dc(t){return function(){this.textContent=t}}function pc(t){return function(){var e=t(this);this.textContent=e??""}}function mc(t){return this.tween("text",typeof t=="function"?pc(ar(this,"text",t)):dc(t==null?"":t+""))}function gc(t){return function(e){this.textContent=t.call(this,e)}}function _c(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&gc(i)),e}return r._value=t,r}function wc(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,_c(t))}function yc(){for(var t=this._name,e=this._id,n=Ji(),r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],o=s.length,c,l=0;l<o;++l)if(c=s[l]){var f=It(c,e);fn(c,t,n,l,s,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Ht(r,this._parents,t,n)}function xc(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,s){var o={value:s},c={value:function(){--i===0&&a()}};n.each(function(){var l=Lt(this,r),f=l.on;f!==t&&(e=(t=f).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(c)),l.on=e}),i===0&&a()})}var vc=0;function Ht(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Ji(){return++vc}var Vt=ee.prototype;Ht.prototype={constructor:Ht,select:ec,selectAll:nc,selectChild:Vt.selectChild,selectChildren:Vt.selectChildren,filter:Xl,merge:Yl,selection:ic,transition:yc,call:Vt.call,nodes:Vt.nodes,node:Vt.node,size:Vt.size,empty:Vt.empty,each:Vt.each,on:Ql,attr:Il,attrTween:Vl,style:cc,styleTween:hc,text:mc,textTween:wc,remove:tc,tween:Al,delay:Hl,duration:Pl,ease:Gl,easeVarying:Zl,end:xc,[Symbol.iterator]:Vt[Symbol.iterator]};function bc(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var kc={time:null,delay:0,duration:250,ease:bc};function $c(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Ac(t){var e,n;t instanceof Ht?(e=t._id,t=t._name):(e=Ji(),(n=kc).time=rr(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],o=s.length,c,l=0;l<o;++l)(c=s[l])&&fn(c,t,e,l,s,n||$c(c,e));return new Ht(r,this._parents,t,e)}ee.prototype.interrupt=bl;ee.prototype.transition=Ac;const Vn=Math.PI,Bn=2*Vn,Xt=1e-6,Ec=Bn-Xt;function Qi(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Tc(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Qi;const n=10**e;return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Rc{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Qi:Tc(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,a,s){this._append`C${+e},${+n},${+r},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(e,n,r,i,a){if(e=+e,n=+n,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,c=r-e,l=i-n,f=s-e,d=o-n,h=f*f+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>Xt)if(!(Math.abs(d*c-l*f)>Xt)||!a)this._append`L${this._x1=e},${this._y1=n}`;else{let u=r-s,w=i-o,T=c*c+l*l,k=u*u+w*w,$=Math.sqrt(T),g=Math.sqrt(h),_=a*Math.tan((Vn-Math.acos((T+h-k)/(2*$*g)))/2),m=_/g,x=_/$;Math.abs(m-1)>Xt&&this._append`L${e+m*f},${n+m*d}`,this._append`A${a},${a},0,0,${+(d*u>f*w)},${this._x1=e+x*c},${this._y1=n+x*l}`}}arc(e,n,r,i,a,s){if(e=+e,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),c=r*Math.sin(i),l=e+o,f=n+c,d=1^s,h=s?i-a:a-i;this._x1===null?this._append`M${l},${f}`:(Math.abs(this._x1-l)>Xt||Math.abs(this._y1-f)>Xt)&&this._append`L${l},${f}`,r&&(h<0&&(h=h%Bn+Bn),h>Ec?this._append`A${r},${r},0,1,${d},${e-o},${n-c}A${r},${r},0,1,${d},${this._x1=l},${this._y1=f}`:h>Xt&&this._append`A${r},${r},0,${+(h>=Vn)},${d},${this._x1=e+r*Math.cos(a)},${this._y1=n+r*Math.sin(a)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Sc(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function tn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function ce(t){return t=tn(Math.abs(t)),t?t[1]:NaN}function Nc(t,e){return function(n,r){for(var i=n.length,a=[],s=0,o=t[0],c=0;i>0&&o>0&&(c+o+1>r&&(o=Math.max(1,r-c)),a.push(n.substring(i-=o,i+o)),!((c+=o+1)>r));)o=t[s=(s+1)%t.length];return a.reverse().join(e)}}function Mc(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Ic=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function en(t){if(!(e=Ic.exec(t)))throw new Error("invalid format: "+t);var e;return new sr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}en.prototype=sr.prototype;function sr(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}sr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Dc(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var ji;function Oc(t,e){var n=tn(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(ji=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return a===s?r:a>s?r+new Array(a-s+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+tn(t,Math.max(0,e+a-1))[0]}function Dr(t,e){var n=tn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Or={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Sc,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Dr(t*100,e),r:Dr,s:Oc,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Lr(t){return t}var Fr=Array.prototype.map,Vr=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Lc(t){var e=t.grouping===void 0||t.thousands===void 0?Lr:Nc(Fr.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?Lr:Mc(Fr.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function l(d){d=en(d);var h=d.fill,u=d.align,w=d.sign,T=d.symbol,k=d.zero,$=d.width,g=d.comma,_=d.precision,m=d.trim,x=d.type;x==="n"?(g=!0,x="g"):Or[x]||(_===void 0&&(_=12),m=!0,x="g"),(k||h==="0"&&u==="=")&&(k=!0,h="0",u="=");var A=T==="$"?n:T==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",y=T==="$"?r:/[%p]/.test(x)?s:"",E=Or[x],b=/[defgprs%]/.test(x);_=_===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function v(p){var D=A,M=y,V,J,at;if(x==="c")M=E(p)+M,p="";else{p=+p;var st=p<0||1/p<0;if(p=isNaN(p)?c:E(Math.abs(p),_),m&&(p=Dc(p)),st&&+p==0&&w!=="+"&&(st=!1),D=(st?w==="("?w:o:w==="-"||w==="("?"":w)+D,M=(x==="s"?Vr[8+ji/3]:"")+M+(st&&w==="("?")":""),b){for(V=-1,J=p.length;++V<J;)if(at=p.charCodeAt(V),48>at||at>57){M=(at===46?i+p.slice(V+1):p.slice(V))+M,p=p.slice(0,V);break}}}g&&!k&&(p=e(p,1/0));var R=D.length+p.length+M.length,B=R<$?new Array($-R+1).join(h):"";switch(g&&k&&(p=e(B+p,B.length?$-M.length:1/0),B=""),u){case"<":p=D+p+M+B;break;case"=":p=D+B+p+M;break;case"^":p=B.slice(0,R=B.length>>1)+D+p+M+B.slice(R);break;default:p=B+D+p+M;break}return a(p)}return v.toString=function(){return d+""},v}function f(d,h){var u=l((d=en(d),d.type="f",d)),w=Math.max(-8,Math.min(8,Math.floor(ce(h)/3)))*3,T=Math.pow(10,-w),k=Vr[8+w/3];return function($){return u(T*$)+k}}return{format:l,formatPrefix:f}}var Ie,ta,ea;Fc({thousands:",",grouping:[3],currency:["$",""]});function Fc(t){return Ie=Lc(t),ta=Ie.format,ea=Ie.formatPrefix,Ie}function Vc(t){return Math.max(0,-ce(Math.abs(t)))}function Bc(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ce(e)/3)))*3-ce(Math.abs(t)))}function Cc(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ce(e)-ce(t))+1}function Hc(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function zc(t){return function(){return t}}function Uc(t){return+t}var Br=[0,1];function ae(t){return t}function Cn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:zc(isNaN(e)?NaN:.5)}function Pc(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function qc(t,e,n){var r=t[0],i=t[1],a=e[0],s=e[1];return i<r?(r=Cn(i,r),a=n(s,a)):(r=Cn(r,i),a=n(a,s)),function(o){return a(r(o))}}function Gc(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)i[s]=Cn(t[s],t[s+1]),a[s]=n(e[s],e[s+1]);return function(o){var c=Za(t,o,1,r)-1;return a[c](i[c](o))}}function Wc(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Zc(){var t=Br,e=Br,n=nr,r,i,a,s=ae,o,c,l;function f(){var h=Math.min(t.length,e.length);return s!==ae&&(s=Pc(t[0],t[h-1])),o=h>2?Gc:qc,c=l=null,d}function d(h){return h==null||isNaN(h=+h)?a:(c||(c=o(t.map(r),e,n)))(r(s(h)))}return d.invert=function(h){return s(i((l||(l=o(e,t.map(r),Nt)))(h)))},d.domain=function(h){return arguments.length?(t=Array.from(h,Uc),f()):t.slice()},d.range=function(h){return arguments.length?(e=Array.from(h),f()):e.slice()},d.rangeRound=function(h){return e=Array.from(h),n=cl,f()},d.clamp=function(h){return arguments.length?(s=h?!0:ae,f()):s!==ae},d.interpolate=function(h){return arguments.length?(n=h,f()):n},d.unknown=function(h){return arguments.length?(a=h,d):a},function(h,u){return r=h,i=u,f()}}function Xc(){return Zc()(ae,ae)}function Yc(t,e,n,r){var i=Qa(t,e,n),a;switch(r=en(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=Bc(i,s))&&(r.precision=a),ea(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=Cc(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Vc(i))&&(r.precision=a-(r.type==="%")*2);break}}return ta(r)}function Kc(t){var e=t.domain;return t.ticks=function(n){var r=e();return Ja(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Yc(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,s=r[i],o=r[a],c,l,f=10;for(o<s&&(l=s,s=o,o=l,l=i,i=a,a=l);f-- >0;){if(l=Rn(s,o,n),l===c)return r[i]=s,r[a]=o,e(r);if(l>0)s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l;else if(l<0)s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l;else break;c=l}return t},t}function Pt(){var t=Xc();return t.copy=function(){return Wc(t,Pt())},Hc.apply(t,arguments),Kc(t)}function De(t){return function(){return t}}const or=Math.sqrt,na=Math.PI,Jc=2*na;function Qc(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Rc(e)}const jc={draw(t,e){const n=or(e/na);t.moveTo(n,0),t.arc(0,0,n,0,Jc)}},wn=or(3),ra={draw(t,e){const n=-or(e/(wn*3));t.moveTo(0,n*2),t.lineTo(-wn*n,-n),t.lineTo(wn*n,-n),t.closePath()}};function ia(t,e){let n=null,r=Qc(i);t=typeof t=="function"?t:De(t||jc),e=typeof e=="function"?e:De(e===void 0?64:+e);function i(){let a;if(n||(n=a=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),a)return n=null,a+""||null}return i.type=function(a){return arguments.length?(t=typeof a=="function"?a:De(a),i):t},i.size=function(a){return arguments.length?(e=typeof a=="function"?a:De(+a),i):e},i.context=function(a){return arguments.length?(n=a??null,i):n},i}function _e(t,e,n){this.k=t,this.x=e,this.y=n}_e.prototype={constructor:_e,scale:function(t){return t===1?this:new _e(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new _e(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};_e.prototype;function lr(t,e,n){let r=0,i,a;if(t.length==0)r=1;else{for(let s=1;s<t.length;s++){for(const o of t[s]){const[c,l]=o.split(":");if(n<+c||e>+l)a=1;else{a=0;break}}if(a){i=1,r=s;break}}i||(r=t.length)}return r}function aa(t,e){let n=-1,r=-1;for(const i of t){const a=i.children;a&&a.forEach(s=>{e.includes(s.type)&&((n<0||s.fmin<n)&&(n=s.fmin),(r<0||s.fmax>r)&&(r=s.fmax))})}return{fmin:n,fmax:r}}function fe(t){const n=t.attr("class").split(" "),r=`.${n[0]}.${n[1]} .track`,i=St(r).nodes();let a=0;return i.forEach(s=>{a+=s.getBoundingClientRect().height+1}),a}function sa(t,e){var i;const n=((i=e.node())==null?void 0:i.getBBox().height)??0;e.selectAll(".variant-deletion,.variant-SNV,.variant-insertion,.variant-delins").filter(a=>{var o;let s=!1;return(o=a.alleles)!=null&&o.length&&(a.alleles[0].replace(/"|\[|\]| /g,"").split(",").forEach(l=>{t.includes(l)&&(s=!0)}),a.alleles.forEach(l=>{t.includes(l)&&(s=!0)})),s}).datum(a=>(a.selected="true",a)).style("stroke","black").each(function(){let a=K(this).attr("x"),s=+K(this).attr("width");(s===0||Number.isNaN(s))&&(s=3,a=String(+a-s/2)),e.select(".deletions.track").append("rect").attr("class","highlight").attr("x",a).attr("width",s).attr("height",n).attr("fill","yellow").attr("opacity",.8).lower()})}const qe={transcript_ablation:{impact:"HIGH",color:"#ff0000"},splice_acceptor_variant:{impact:"HIGH",color:"#ff581a"},splice_donor_variant:{impact:"HIGH",color:"#ff581a"},stop_gained:{impact:"HIGH",color:"#ff0000"},frameshift_variant:{impact:"HIGH",color:"#9400D3"},stop_lost:{impact:"HIGH",color:"#ff0000"},start_lost:{impact:"HIGH",color:"#ffd700"},transcript_amplification:{impact:"HIGH",color:"#ff69b4"},inframe_insertion:{impact:"MODERATE",color:"#ff69b4"},inframe_deletion:{impact:"MODERATE",color:"#ff69b4"},missense_variant:{impact:"MODERATE",color:"#ffd700"},protein_altering_variant:{impact:"MODERATE",color:"#ff0080"},splice_region_variant:{impact:"LOW",color:"#ff7f50"},incomplete_terminal_codon_variant:{impact:"LOW",color:"#ff00ff"},start_retained_variant:{impact:"LOW",color:"#76ee00"},stop_retained_variant:{impact:"LOW",color:"#76ee00"},synonymous_variant:{impact:"LOW",color:"#76ee00"},coding_sequence_variant:{impact:"MODIFIER",color:"#458b00"},mature_miRNA_variant:{impact:"MODIFIER",color:"#458b00"},five_prime_UTR_variant:{impact:"MODIFIER",color:"#7ac5cd"},three_prime_UTR_variant:{impact:"MODIFIER",color:"#7ac5cd"},non_coding_transcript_exon_variant:{impact:"MODIFIER",color:"#32cd32"},intron_variant:{impact:"MODIFIER",color:"#02599c"},NMD_transcript_variant:{impact:"MODIFIER",color:"#ff4500"},non_coding_transcript_variant:{impact:"MODIFIER",color:"#32cd32"},upstream_gene_variant:{impact:"MODIFIER",color:"#a2b5cd"},downstream_gene_variant:{impact:"MODIFIER",color:"#a2b5cd"},TFBS_ablation:{impact:"MODIFIER",color:"#a52a2a"},TFBS_amplification:{impact:"MODIFIER",color:"#a52a2a"},TF_binding_site_variant:{impact:"MODIFIER",color:"#a52a2a"},regulatory_region_ablation:{impact:"MODERATE",color:"#a52a2a"},regulatory_region_amplification:{impact:"MODIFIER",color:"#a52a2a"},feature_elongation:{impact:"MODIFIER",color:"#7f7f7f"},regulatory_region_variant:{impact:"MODIFIER",color:"#a52a2a"},feature_truncation:{impact:"MODIFIER",color:"#7f7f7f"},intergenic_variant:{impact:"MODIFIER",color:"#636363"}};function tf(t){if(!t)return"black";if(t.split(" ").length>1)return"hotpink";if(t==="UNKNOWN")return"gray";const e=qe[t];return e?e.color:t==="5_prime_UTR_variant"?qe.five_prime_UTR_variant.color:t==="3_prime_UTR_variant"?qe.three_prime_UTR_variant.color:(console.warn("Consequence",t,"not found"),"#f0f")}const Jt=10,Ut=10;function cr(t){return`${t},${Jt} ${t+Ut/2},${Jt/2} ${t},0 ${t-Ut/2},${Jt/2}`}function oa(t){return`${t-Ut/2},${Jt} ${t},0 ${t+Ut/2},${Jt}`}function Cr(t,e,n){if(t.length==0)return 0;{let r=!0,i=0;return t.sort((a,s)=>a.row>s.row?1:-1),t.every(a=>i!=a.row&&r?!1:(i!=a.row&&(i=a.row,r=!0),a.fmin>e&&a.fmin>n||a.fmax<n&&a.fmax<e||(r=!1),!0)),r?i:i+1}}function la(t){return`${t-Ut/2},${Jt} ${t+Ut/2},${Jt} ${t-Ut/2},0 ${t+Ut/2},0`}function ef(t){const e=Object.keys(t).length;return{descriptionWidth:Math.max(...Object.entries(t).map(r=>{var i;return((i=r[1])==null?void 0:i.length)??0})),descriptionHeight:e}}function nf(t,e,n){const{fmax:r,fmin:i,type:a}=e;return t.findIndex(s=>{const o=s.fmin+n,c=s.fmax-n;return a!==s.type?!1:o<=i&&c>=i||c<=r&&c>=r||o>=i&&c<=r})}function rf(t){const e=[];return t.forEach(n=>{const r=fr(n),{type:i,fmax:a,fmin:s}=n,o=e.findIndex(c=>{const l=c.fmin,f=c.fmax;return c.type!==i||c.consequence!==r?!1:l<=s&&f>=s||f<=a&&f>=a||l>=s&&f<=a});if(o!==-1){const c=e[o],l=e[o].variantSet?e[o].variantSet.findIndex(f=>f.type===i&&f.consequence===r):-1;l>=0?e[l].variantSet.push(n):e[o].variantSet=[{variants:[n],type:i,consequence:r}],c.variants.push(n),c.fmin=Math.min(s,c.fmin),c.fmax=Math.max(a,c.fmax),e[o]=c}else{const c={fmin:s,fmax:a,type:i,consequence:r,variantSet:[{variants:[n],type:i,consequence:r}],variants:[n]};e.push(c)}}),e}function ca(t,e){const n=[];return t.forEach(r=>{const i=fr(r),{type:a,fmax:s,fmin:o}=r,c=nf(n,r,e);if(c>=0&&a!="deletion"){const l=n[c],f=l.variantSet?l.variantSet.findIndex(d=>d.type===a&&d.consequence===i):-1;if(f>=0){const d=Math.min(l.variantSet[f].fmin,o),h=Math.max(l.variantSet[f].fmax,s);l.fmin=d,l.fmax=h,l.variantSet[f].fmin=d,l.variantSet[f].fmax=h,l.variantSet[f].variants.push(r)}else{const d=Math.min(l.fmin,o),h=Math.max(l.fmax,s);l.fmin=d,l.fmax=h,l.variantSet.push({variants:[r],type:a,consequence:i,fmin:o,fmax:s})}l.variants.push(r),l.fmin=Math.min(o,l.fmin),l.fmax=Math.max(s,l.fmax),n[c]=l}else n.push({fmin:o,fmax:s,type:a,consequence:i,variantSet:[{variants:[r],type:a,consequence:i,fmin:o,fmax:s}],variants:[r]})}),n}function Hn(t){if(t.length===1){let e='<div style="margin-top: 30px;">';return e+=Hr(t[0]),e+="</div>",e}else if(t.length>1){let e='<ul style="list-style-type: none; margin-top: 30px;">';for(const n of t)e+=`<li style="border-bottom: solid 1px black;">${Hr(n)}</li>`;return e+="</ul>",e}else return"No data available"}function Hr(t){const{descriptionWidth:e}=ef(t);let n="";const r=t.location,[i,a]=r.split(":")[1].split("..");let s=t.alternative_alleles,o=t.reference_allele,c;if(t.type==="SNV")c="1bp";else if(t.type==="deletion")c=`${o.length-1}bp deleted`;else if(t.type==="insertion")s==="ALT_MISSING"?(c="unknown length inserted",s="n+"):c=`${s.length-1}bp inserted`;else if(t.type==="MNV")c=`${o.length}bp`;else if(t.type==="delins"){const f=`${o.length-1}bp deleted`;let d;s==="ALT_MISSING"?(d="unknown length inserted",s="n+"):d=`${s.length-1}bp inserted`,c=`${f}; ${d}`}else c=`${+a-+i}bp`;o=o.length>20?`${o.slice(0,1).toLowerCase()+o.slice(1,8).toUpperCase()}...${o.slice(Math.max(0,o.length-8)).toUpperCase()}`:o.slice(0,1).toLowerCase()+o.slice(1).toUpperCase(),s=s.length>20?`${s.slice(0,1).toLowerCase()+s.slice(1,8).toUpperCase()}...${s.slice(Math.max(0,s.length-8)).toUpperCase()}`:s.slice(0,1).toLowerCase()+s.slice(1).toUpperCase(),(t.type==="SNV"||t.type==="MNV")&&(s=s.toUpperCase(),o=o.toUpperCase());let l="";return t.type==="insertion"?l=`ins: ${s}`:t.type==="deletion"?l=`del: ${o}`:l=`${o}->${s}`,n+='<table class="tooltip-table"><tbody>',n+=`<tr><th>Symbol</th><td>${t.symbolDetail}</td></tr>`,n+=`<tr><th>Type</th><td>${t.type}</td></tr>`,n+=`<tr><th>Consequence</th><td>${t.consequence}</td></tr>`,t.impact&&(n+=`<tr><th>Impact</th><td>${t.impact.length>e?t.impact.slice(0,Math.max(0,e)):t.impact}</td></tr>`),n+=`<tr><th>Length</th><td>${c}</td></tr>`,t.name!==t.symbol&&(n+=`<tr><th>Name</th><td>${t.name}</td></tr>`),t.geneId&&t.geneSymbol?n+=`<tr><th>Allele of Genes</th><td> ${t.geneSymbol.length>e?t.geneSymbol.slice(0,Math.max(0,e)):t.geneSymbol} (${t.geneId})</td></tr>`:t.allele_of_genes&&(n+=`<tr><th>Allele of Genes</th><td>${t.allele_of_genes.length>e?t.allele_of_genes.slice(0,Math.max(0,e)):t.allele_of_genes}</td></tr>`),t.alternative_alleles&&(n+=`<tr><th>Sequence Change</th><td>${l}</td></tr>`),n+="</tbody></table>",n}function zn(t){return t.variants.map(e=>{const n=af(e);return{...n,consequence:n.consequence||"UNKNOWN"}})}function zr(t){return t.variants.flatMap(e=>{var r;const n=(r=e.allele_ids)==null?void 0:r.values[0].replace(/"/g,"");return n==null?void 0:n.split(",").map(i=>i.replace(/\[|\]| /g,""))}).filter(e=>!!e)}function Un(t){return t.map(e=>tf(e.consequence))}function fr(t){var n;let e="UNKNOWN";return(n=t.geneLevelConsequence)!=null&&n.values&&t.geneLevelConsequence.values.length>0&&(e=t.geneLevelConsequence.values[0].replace(/\|/g," ").replace(/"/g,"")),e}function Oe(t){return(Array.isArray(t==null?void 0:t.values)?t.values.join(" "):t==null?void 0:t.values)??""}function af(t){var e,n;return{symbol:be(t),symbolDetail:fa(t),location:`${t.seqId}:${t.fmin}..${t.fmax}`,consequence:fr(t),type:t.type,name:t.name,description:t.description,reference_allele:t.reference_allele,geneId:(e=t.allele_of_gene_ids)==null?void 0:e.values[0].replace(/"/g,""),geneSymbol:(n=t.allele_of_gene_symbols)==null?void 0:n.values[0].replace(/"/g,""),allele_of_genes:Oe(t.allele_of_genes),allele_ids:Oe(t.allele_ids),alternative_alleles:Oe(t.alternative_alleles),impact:Oe(t.impact)}}function fa(t){var e,n,r;if(t.variants)return t.variants.length!==1?`${t.variants.length}`:fa(t.variants[0]);if((e=t.allele_symbols)!=null&&e.values)if(t.allele_symbols.values[0].split(",").length>1)try{const i=[],a=t.allele_symbols.values[0].replace(/"|\[|\]/g,""),s=((n=t.allele_ids)==null?void 0:n.values[0].replace(/"|\[|\]/g,""))??"",o=a.split(","),c=s.split(",");for(let l=0;l<c.length;l++)i.push(`${o[l].trim()} (${c[l].trim()})`);return i.join(", ")}catch(i){return console.error(i),`${t.allele_symbols.values[0].split(",").length}`}else return`${t.allele_symbols.values[0].replace(/"/g,"")}(${(r=t.allele_ids)==null?void 0:r.values[0].replace(/"|\[|\]/g,"")})`;return""}function be(t){var e;if(t.variants)return t.variants.length!==1?`${t.variants.length}`:be(t.variants[0]);if((e=t.allele_symbols_text)!=null&&e.values){const n=t.allele_symbols_text.values[0].split(",");return n.length>1?`${n.length}`:t.allele_symbols_text.values[0].replace(/"/g,"")}return""}function sf(t){const e=[];for(const n of t)n.type.toLowerCase()==="deletion"||(n.type.toLowerCase()==="snv"||n.type.toLowerCase()==="point_mutation"?e.push("snv"):n.type.toLowerCase()==="insertion"?e.push("insertion"):(n.type.toLowerCase()==="delins"||n.type.toLowerCase()==="substitution"||n.type.toLowerCase()==="indel"||n.type.toLowerCase()==="mnv")&&e.push("delins"));return[...new Set(e)].sort()}function Pn(t,e){return`<svg width="15" top="3" viewBox="0 -2 15 15" style="display: inline;" xmlns="http://www.w3.org/2000/svg"><rect fill="${t}" stroke="none" height="10" width="10"></svg>${e}</polygons></svg>`}function it(t){return t=="unknown"?Pn("grey",t.replace(/_/g," ")):Pn(qe[t].color,t.replace(/_/g," "))}function of(){let t="<table><tbody>";return t+="<tr>",t+='<td align="center" valign="top"><u><b>Variant types</b></u></td>',t+='<td align="center" valign="top" colspan="2"><u><b>Molecular Consequences</b></u></td>',t+="</tr>",t+="<tr>",t+='<td valign="top" ><ul style="list-style-type:none;">',t+=`<li><svg width="15" top="3" viewBox="-7 -2 15 15" style="display: inline;" xmlns="http://www.w3.org/2000/svg"><polygon stroke="black" fill="black" points="${cr(0)}"></svg>point mutation</polygons></svg></li>`,t+=`<li>${Pn("black","deletion")}</li>`,t+=`<li><svg width="15" top="3" viewBox="-7 -2 15 15" style="display: inline;" xmlns="http://www.w3.org/2000/svg"><polygon stroke="black" fill="black" points="${oa(0)}"></svg>insertion</polygons></svg></li>`,t+=`<li><svg width="15" top="3" viewBox="-7 -2 15 15" style="display: inline;" xmlns="http://www.w3.org/2000/svg"><polygon stroke="black" fill="black" points="${la(0)}"></svg>delins/MNV </polygons></svg></li>`,t+="</ul></td>",t+='<td valign="top" ><ul style="list-style-type:none;">',t+=`<li>${it("transcript_ablation")}</li>`,t+=`<li>${it("splice_acceptor_variant")}</li>`,t+=`<li>${it("splice_donor_variant")}</li>`,t+=`<li>${it("stop_gained")}</li>`,t+=`<li>${it("frameshift_variant")}</li>`,t+=`<li>${it("stop_lost")}</li>`,t+=`<li>${it("start_lost")}</li>`,t+=`<li>${it("inframe_insertion")}</li>`,t+=`<li>${it("inframe_deletion")}</li>`,t+=`<li>${it("missense_variant")}</li>`,t+="</ul></td>",t+='<td valign="top" ><ul style="list-style-type:none;">',t+=`<li>${it("protein_altering_variant")}</li>`,t+=`<li>${it("splice_region_variant")}</li>`,t+=`<li>${it("start_retained_variant")}</li>`,t+=`<li>${it("stop_retained_variant")}</li>`,t+=`<li>${it("synonymous_variant")}</li>`,t+=`<li>${it("coding_sequence_variant")}</li>`,t+=`<li>${it("five_prime_UTR_variant")}</li>`,t+=`<li>${it("three_prime_UTR_variant")}</li>`,t+=`<li>${it("intron_variant")}</li>`,t+=`<li>${it("non_coding_transcript_variant")}</li>`,t+=`<li>${it("unknown")}</li>`,t+="</ul></td>",t+="</tr>",t+="<tr>",t+="<td></td>",t+='<td colspan="2"><a href="https://uswest.ensembl.org/info/genome/variation/prediction/predicted_data.html">Source: Ensembl</a></td>',t+="</tr>",t+="</tbody></table>",t}function lf(t){return t===1?"+":t===-1?"-":t}function ft(t){let e="";return e+='<table class="tooltip-table" style="margin-top: 30px;"><tbody>',e+=t.id.includes("http")?`<tr><th>Name</th><td>${t.name}</td></tr>`:`<tr><th>Name</th><td>${t.name} (${t.id})</td></tr>`,e+=`<tr><th>Type</th><td>${t.type}</td></tr>`,e+=`<tr><th>Source</th><td>${t.source}</td></tr>`,e+=`<tr><th>Location</th><td>${t.seqId}:${t.fmin}..${t.fmax} (${lf(t.strand)})</td></tr>`,e+="</tbody></table>",e}function ua(t,e,n,r){let i="";if(t==="FlyBase")i=`https://alliancegenome.org/jbrowse/?data=data%2FDrosophila%20melanogaster&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="MGI")i=`https://alliancegenome.org/jbrowse/?data=data%2FMus%20musculus&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="WormBase")i=`https://alliancegenome.org/jbrowse/?data=data%2FCaenorhabditis%20elegans&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="ZFIN")i=`https://alliancegenome.org/jbrowse/?data=data%2FDanio%20rerio&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="SGD")i=`https://alliancegenome.org/jbrowse/?data=data%2FSaccharomyces%20cerevisiae&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="RGD")i=`https://alliancegenome.org/jbrowse/?data=data%2FRattus%20norvegicus&tracks=Variants%2CAll%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else if(t==="human")i=`https://alliancegenome.org/jbrowse/?data=data%2FHomo%20sapiens&tracks=All%20Genes&highlight=&loc=${e}%3A${n}..${r}`;else return console.warn("no source found",t),"Maximum features displayed.  See full view for more.";return`<a href="${i}">Maximum features displayed.  See full view for more.</a>`}class cf{constructor({viewer:e,height:n,width:r,transcriptTypes:i,variantTypes:a,showVariantLabel:s,variantFilter:o,binRatio:c,isoformFilter:l,initialHighlight:f,trackData:d,variantData:h,region:u}){this.region=u,this.trackData=d??[],this.variantData=h??[],this.viewer=e,this.width=r,this.variantFilter=o,this.isoformFilter=l,this.initialHighlight=f,this.height=n,this.transcriptTypes=i,this.variantTypes=a,this.binRatio=c,this.showVariantLabel=s??!0}DrawTrack(){const e=this.variantData,n=this.trackData,r=this.isoformFilter;let i=n;const a=this.initialHighlight,s=this.filterVariantData(e,this.variantFilter),o=this.viewer,c=this.width,l=this.binRatio,f=sf(s),d=f.length,h=n[0].source,u=n[0].seqId,w=r.length===0?9:30,T=["UTR","five_prime_UTR","three_prime_UTR"],k=["CDS"],$=["exon"],g=this.transcriptTypes,_=aa(i,g),m=_.fmin,x=_.fmax,A=10,y=10,E=40,b=20,v=2,p=0,D=10,M=10,V=4,J=20,at=10,st=`0,0 0,${J} ${at},${at}`,R=10,B=40,At=22.5,L=Pt().domain([m,x]).range([0,c]),F=o.append("g").attr("class","deletions track").attr("transform","translate(0,22.5)"),kt=o.append("g").attr("class","label"),tt={};for(let C=0,N=T.length;C<N;C++)tt[T[C]]=200;for(let C=0,N=k.length;C<N;C++)tt[k[C]]=1e3;for(let C=0,N=$.length;C<N;C++)tt[$[C]]=100;const ht={};i=i.sort((C,N)=>C.selected&&!N.selected?-1:!C.selected&&N.selected?1:C.name.localeCompare(N.name));let ut=0;const q=K("body").append("div").attr("class","gfc-tooltip").style("visibility","visible").style("opacity",0),et=()=>{q.transition().duration(100).style("opacity",10).style("visibility","hidden")},Ft=ca(s,(x-m)*l),dt=Ft.filter(C=>C.type=="deletion"),U=Ft.filter(C=>C.type!=="deletion"),ot=[];dt.forEach(C=>{var vt;const{fmax:N,fmin:Z}=C,z=this.width,_t=be(C),I=zn(C),pt=zr(C),ct=Hn(I),W=Un(I)[0];ot.push({fmin:Z,fmax:N,row:Cr(ot,Z,N)});const wt=Math.max(Math.ceil(L(N)-L(Z)),v);F.append("rect").attr("class","variant-deletion").attr("id",`variant-${Z}`).attr("x",L(Z)).attr("transform",`translate(0,${M*Cr(ot,Z,N)})`).attr("z-index",30).attr("fill",W).attr("height",M).attr("width",wt).on("click",()=>{Y(q,ct,et)}).on("mouseover",Q=>{const mt=Q.variant;St(".variant-deletion").filter(P=>P.variant===mt).style("stroke","black"),K(".label").selectAll(".variantLabel,.variantLabelBackground").raise().filter(P=>P.variant===mt).style("opacity",1)}).on("mouseout",()=>{St(".variant-deletion").filter(Q=>Q.selected!=="true").style("stroke",null),K(".label").selectAll(".variantLabel,.variantLabelBackground").style("opacity",0)}).datum({fmin:Z,fmax:N,variant:_t+Z,alleles:pt});{let Q=0;Q=L(Z);const mt=M*d+At,P=kt.append("text").attr("class","variantLabel").attr("fill",W).attr("opacity",0).attr("height",p).attr("transform",`translate(${Q},${mt})`).text(_t).on("click",()=>{Y(q,ct,et)}).datum({fmin:Z,variant:_t+Z}),nt=((vt=P.node())==null?void 0:vt.getBBox().width)??0;if(nt+Q>z){const rt=nt+Q-z;Q-=rt,P.attr("transform",`translate(${Q},${mt})`)}}});const Rt=fe(this.viewer),xt=o.append("g").attr("class","variants track").attr("transform",`translate(0,${Rt})`);U.forEach(C=>{var mt;const{type:N,fmax:Z,fmin:z}=C;let _t=!0,I=!1;const pt=this.width,ct=be(C),W=zn(C),wt=zr(C),vt=Hn(W),Q=Un(W)[0];if(N.toLowerCase()==="snv"||N.toLowerCase()==="point_mutation"?(I=!0,xt.append("polygon").attr("class","variant-SNV").attr("id",`variant-${z}`).attr("points",cr(L(z))).attr("fill",Q).attr("x",L(z)).attr("transform",`translate(0,${M*f.indexOf("snv")})`).attr("z-index",30).on("click",()=>{Y(q,vt,et)}).on("mouseover",function(P){const nt=P.variant;St(".variant-SNV").filter(rt=>rt.variant===nt).style("stroke","black"),K(".label").selectAll(".variantLabel,.variantLabelBackground").raise().filter(rt=>rt.variant===nt).style("opacity",1)}).on("mouseout",()=>{St(".variant-SNV").filter(P=>P.selected!="true").style("stroke",null),K(".label").selectAll(".variantLabel,.variantLabelBackground").style("opacity",0)}).datum({fmin:z,fmax:Z,variant:ct+z,alleles:wt})):N.toLowerCase()==="insertion"?(I=!0,xt.append("polygon").attr("class","variant-insertion").attr("id",`variant-${z}`).attr("points",oa(L(z))).attr("fill",Q).attr("x",L(z)).attr("transform",`translate(0,${M*f.indexOf("insertion")})`).attr("z-index",30).on("click",()=>{Y(q,vt,et)}).on("mouseover",P=>{const nt=P.variant;St(".variant-insertion").filter(rt=>rt.variant===nt).style("stroke","black"),K(".label").selectAll(".variantLabel,.variantLabelBackground").raise().filter(rt=>rt.variant===nt).style("opacity",1)}).on("mouseout",()=>{St(".variant-insertion").filter(P=>P.selected!="true").style("stroke",null),K(".label").selectAll(".variantLabel,.variantLabelBackground").style("opacity",0)}).datum({fmin:z,fmax:Z,variant:ct+z,alleles:wt})):N.toLowerCase()==="delins"||N.toLowerCase()==="substitution"||N.toLowerCase()==="indel"||N.toLowerCase()==="mnv"?(I=!0,xt.append("polygon").attr("class","variant-delins").attr("id",`variant-${z}`).attr("points",la(L(z))).attr("x",L(z)).attr("transform",`translate(0,${M*f.indexOf("delins")})`).attr("fill",Q).attr("z-index",30).on("click",()=>{Y(q,vt,et)}).on("mouseover",P=>{const nt=P.variant;St(".variant-delins").filter(rt=>rt.variant===nt).style("stroke","black"),K(".label").selectAll(".variantLabel,.variantLabelBackground").raise().filter(rt=>rt.variant===nt).style("opacity",1)}).on("mouseout",()=>{St(".variant-delins").filter(P=>P.selected!="true").style("stroke",null),K(".label").selectAll(".variantLabel,.variantLabelBackground").style("opacity",0)}).datum({fmin:z,fmax:Z,variant:ct+z,alleles:wt})):(console.warn("type not found",N,C),_t=!1),_t){let P=0;P=I?L(z)-R/2:L(z);const nt=M*d+At,rt=kt.append("text").attr("class","variantLabel").attr("fill",Q).attr("opacity",0).attr("height",p).attr("transform",`translate(${P},${nt})`).text(ct).on("click",()=>{Y(q,vt,et)}).datum({fmin:z,variant:ct+z}),G=((mt=rt.node())==null?void 0:mt.getBBox().width)??0;if(G+P>pt){const zt=G+P-pt;P-=zt,rt.attr("transform",`translate(${P},35)`)}}});const qt=Rt;kt.attr("transform",`translate(0,${qt})`);const S=fe(this.viewer)+At,gt=o.append("g").attr("transform",`translate(0,${S})`).attr("class","track");let X=0;const lt=[];let Gt=-1,re=-1;const Y=this.renderTooltipDescription,Wt=[];for(let C=0;C<i.length&&X<w;C++){const N=i[C];let Z=N.children;if(Z){const z=N.selected;Z=Z.sort((I,pt)=>I.name.localeCompare(pt.name));let _t=!1;Z.forEach(I=>{var ct;if(!(r.includes(I.id)||r.includes(I.name))&&r.length!==0||Wt.includes(I.id))return;Wt.push(I.id);const pt=I.type;if(g.includes(pt)){let W=lr(lt,L(I.fmin),L(I.fmax));if(X<w){let wt="",vt,Q=!1;const mt=N.name;Object.keys(ht).includes(mt)||(ut+=b,Q=!0,ht[mt]="Green");const P=gt.append("g").attr("class","isoform").attr("transform",`translate(0,${X*E+10+ut})`);Q&&(wt=mt,vt=P.append("text").attr("class","geneLabel").attr("fill",z?"sandybrown":"black").attr("height",p).attr("transform",`translate(${L(I.fmin)},-${b})`).text(wt).on("click",()=>{Y(q,ft(N),et)}).datum({fmin:I.fmin})),P.append("polygon").datum(()=>({fmin:I.fmin,fmax:I.fmax,strand:N.strand})).attr("class","transArrow").attr("points",st).attr("transform",G=>N.strand>0?`translate(${Number(L(G.fmax))},0)`:`translate(${Number(L(G.fmin))},${J}) rotate(180)`).on("click",()=>{Y(q,ft(I),et)}),P.append("rect").attr("class","transcriptBackbone").attr("y",10+p).attr("height",V).attr("transform",`translate(${L(I.fmin)},0)`).attr("width",L(I.fmax)-L(I.fmin)).on("click",()=>{Y(q,ft(I),et)}).datum({fmin:I.fmin,fmax:I.fmax}),wt=I.name,vt=P.append("text").attr("class","transcriptLabel").attr("fill",z?"sandybrown":"gray").attr("opacity",z?1:.5).attr("height",p).attr("transform",`translate(${L(I.fmin)},0)`).text(wt).on("click",()=>{Y(q,ft(I),et)}).datum({fmin:I.fmin});let nt=wt.length*2;try{nt=((ct=vt.node())==null?void 0:ct.getBBox().width)??0}catch{}Number(nt+L(I.fmin))>c;const rt=nt>L(I.fmax)-L(I.fmin)?L(I.fmin)+nt:L(I.fmax);if(lt[W]){const G=lt[W];G.push(`${L(I.fmin)}:${rt}`),lt[W]=G}else lt[W]=[`${L(I.fmin)}:${rt}`];(Gt<0||Gt>I.fmin)&&(Gt=I.fmin),(re<0||re<I.fmax)&&(re=I.fmax),I.children&&(I.children=I.children.sort((G,zt)=>{const Ee=tt[G.type],Te=tt[zt.type];return typeof Ee=="number"&&typeof Te=="number"?Ee-Te:typeof Ee=="number"&&typeof Te!="number"?-1:typeof Ee!="number"&&typeof Te=="number"?1:G.type.localeCompare(zt.type)}),I.children.forEach(G=>{const zt=G.type;$.includes(zt)?P.append("rect").attr("class","exon").attr("x",L(G.fmin)).attr("transform",`translate(0,${A-V})`).attr("height",A).attr("z-index",10).attr("width",L(G.fmax)-L(G.fmin)).on("click",()=>{Y(q,ft(I),et)}).datum({fmin:G.fmin,fmax:G.fmax}):k.includes(zt)?P.append("rect").attr("class","CDS").attr("x",L(G.fmin)).attr("transform",`translate(0,${y-V})`).attr("z-index",20).attr("height",y).attr("width",L(G.fmax)-L(G.fmin)).on("click",()=>{Y(q,ft(I),et)}).datum({fmin:G.fmin,fmax:G.fmax}):T.includes(zt)&&P.append("rect").attr("class","UTR").attr("x",L(G.fmin)).attr("transform",`translate(0,${D-V})`).attr("z-index",20).attr("height",D).attr("width",L(G.fmax)-L(G.fmin)).on("click",()=>{Y(q,ft(I),et)}).datum({fmin:G.fmin,fmax:G.fmax})})),X+=1}if(X===w&&!_t){const wt=ua(h,u,m,x);++W,_t=!0,gt.append("a").attr("class","transcriptLabel").attr("xlink:show","new").append("text").attr("x",10).attr("y",10).attr("transform",`translate(0,${X*E+20+ut})`).attr("fill","red").attr("opacity",1).attr("height",p).html(wt)}}})}}return a&&sa(a,o),X===0&&gt.append("text").attr("x",30).attr("y",p+10).attr("fill","orange").attr("opacity",.6).text("Overview of non-coding genome features unavailable at this time."),X*E+ut+B}filterVariantData(e,n){return n.length===0?e:e.filter(r=>{var a,s,o,c;let i=!1;try{(n.includes(r.name)||(a=r.allele_symbols)!=null&&a.values&&n.includes(r.allele_symbols.values[0].replace(/"/g,""))||(s=r.symbol)!=null&&s.values&&n.includes(r.symbol.values[0].replace(/"/g,""))||(o=r.symbol_text)!=null&&o.values&&n.includes(r.symbol_text.values[0].replace(/"/g,"")))&&(i=!0),(((c=r.allele_ids)==null?void 0:c.values[0].replace(/"|\[|\]| /g,"").split(","))??[]).forEach(f=>{n.includes(f)&&(i=!0)})}catch(l){console.error("error processing filter with so returning anyway",n,r,l),i=!0}return i})}renderTooltipDescription(e,n,r){e.transition().duration(200).style("width","auto").style("height","auto").style("opacity",1).style("visibility","visible"),e.html(n).style("left",`${window.event.pageX+10}px`).style("top",`${window.event.pageY+10}px`).append("button").attr("type","button").text("Close").on("click",()=>{r()}),e.append("button").attr("type","button").html("&times;").attr("class","tooltipDivX").on("click",()=>{r()})}setInitialHighlight(e,n){var a;const r=((a=n.node())==null?void 0:a.getBBox().height)??0;n.selectAll(".variant-deletion,.variant-SNV,.variant-insertion,.variant-delins").filter(s=>{let o=!1;return s.alleles&&(s.alleles[0].replace(/"|\[|\]| /g,"").split(",").forEach(l=>{e.includes(l)&&(o=!0)}),s.alleles.forEach(l=>{e.includes(l)&&(o=!0)})),o}).datum(s=>(s.selected="true",s)).style("stroke","black").each(function(){const s=+(K(this).attr("width")||3),o=+K(this).attr("x")-s/2;n.select(".deletions.track").append("rect").attr("class","highlight").attr("x",o).attr("width",s).attr("height",r).attr("fill","yellow").attr("opacity",.8).lower()})}}class ff{constructor({viewer:e,height:n,width:r,transcriptTypes:i,variantTypes:a,showVariantLabel:s,variantFilter:o,trackData:c,variantData:l}){this.trackData=c??[],this.variantData=l??[],this.viewer=e,this.width=r,this.variantFilter=o,this.height=n,this.transcriptTypes=i,this.variantTypes=a,this.showVariantLabel=s??!0}DrawTrack(){const e=this.variantData;let r=this.trackData;const i=this.filterVariantData(e,this.variantFilter),a=this.viewer,s=this.width,o=this.showVariantLabel,c=["UTR","five_prime_UTR","three_prime_UTR"],l=["CDS"],f=["exon"],d=this.transcriptTypes,h=aa(r,d),u=h.fmin,w=h.fmax,T=10,k=10,$=10,g=40,_=20,m=2,x=0,A=10,y=10,E=20,b=4,v=20,p=10,D=`0,0 0,${v} ${p},${p}`,M=10,V=10,J=U=>`${U-V/2},${M} ${U},0 ${U+V/2},${M}`,at=U=>`${U-V/2},${M} ${U+V/2},${M} ${U-V/2},0 ${U+V/2},0`,st=U=>`${U},${M} ${U+V/2},${M/2} ${U},0 ${U-V/2},${M/2}`,R=Pt().domain([u,w]).range([0,s]),B=fe(this.viewer),At=a.append("g").attr("transform",`translate(0,${B})`).attr("class","track"),L={};for(const U of c)L[U]=200;for(const U of l)L[U]=1e3;for(const U of f)L[U]=100;const F={};r=r.sort((U,ot)=>U.selected&&!ot.selected?-1:!U.selected&&ot.selected?1:U.name-ot.name);let kt=0;const tt=K("body").append("div").attr("class","gfc-tooltip").style("visibility","visible").style("opacity",0),ht=()=>{tt.transition().duration(100).style("opacity",10).style("visibility","hidden")};let ut=0;const q=[];let et=-1,Ft=-1;const dt=this.renderTooltipDescription;for(let U=0;U<r.length&&ut<T;U++){const ot=r[U];let Rt=ot.children;if(Rt){const xt=ot.selected;Rt=Rt.sort((S,gt)=>S.name<gt.name?-1:S.name>gt.name?1:S-gt);let qt=!1;Rt.forEach(S=>{const gt=S.type;if(d.includes(gt)){let X=lr(q,R(S.fmin),R(S.fmax));if(ut<T){let lt,Gt,re=!1;Object.keys(F).includes(ot.name)||(kt+=_,re=!0,F[ot.name]="Green");const Y=At.append("g").attr("class","isoform").attr("transform",`translate(0,${ut*g+10+kt})`);re&&(lt=ot.name,Gt=Y.append("text").attr("class","geneLabel").attr("fill",xt?"sandybrown":"black").attr("height",x).attr("transform",`translate(${R(S.fmin)},-${_})`).text(lt).on("click",()=>{dt(tt,ft(ot),ht)}).datum({fmin:S.fmin})),Y.append("polygon").datum(()=>({fmin:S.fmin,fmax:S.fmax,strand:ot.strand})).attr("class","transArrow").attr("points",D).attr("transform",N=>ot.strand>0?`translate(${Number(R(N.fmax))},0)`:`translate(${Number(R(N.fmin))},${v}) rotate(180)`).on("click",()=>{dt(tt,ft(S),ht)}),Y.append("rect").attr("class","transcriptBackbone").attr("y",10+x).attr("height",b).attr("transform",`translate(${R(S.fmin)},0)`).attr("width",R(S.fmax)-R(S.fmin)).on("click",()=>{dt(tt,ft(S),ht)}).datum({fmin:S.fmin,fmax:S.fmax}),lt=S.name,Gt=Y.append("text").attr("class","transcriptLabel").attr("fill",xt?"sandybrown":"gray").attr("opacity",xt?1:.5).attr("height",x).attr("transform",`translate(${R(S.fmin)},0)`).text(lt).on("click",()=>{dt(tt,ft(S),ht)}).datum({fmin:S.fmin});let Wt=lt.length*2;try{Wt=Gt.node().getBBox().width}catch{}Number(Wt+R(S.fmin))>s;const C=Wt>R(S.fmax)-R(S.fmin)?R(S.fmin)+Wt:R(S.fmax);if(q[X]){const N=q[X];N.push(`${R(S.fmin)}:${C}`),q[X]=N}else q[X]=[`${R(S.fmin)}:${C}`];(et<0||et>S.fmin)&&(et=S.fmin),(Ft<0||Ft<S.fmax)&&(Ft=S.fmax),S.children&&(S.children=S.children.sort((N,Z)=>{const z=L[N.type],_t=L[Z.type];return typeof z=="number"&&typeof _t=="number"?z-_t:typeof z=="number"&&typeof _t!="number"?-1:typeof z!="number"&&typeof _t=="number"?1:N.type-Z.type}),S.children.forEach(N=>{const Z=N.type;let z=!1;if(f.includes(Z)?(z=!0,Y.append("rect").attr("class","exon").attr("x",R(N.fmin)).attr("transform",`translate(0,${k-b})`).attr("height",k).attr("z-index",10).attr("width",R(N.fmax)-R(N.fmin)).on("click",()=>{dt(tt,ft(S),ht)}).datum({fmin:N.fmin,fmax:N.fmax})):l.includes(Z)?(z=!0,Y.append("rect").attr("class","CDS").attr("x",R(N.fmin)).attr("transform",`translate(0,${$-b})`).attr("z-index",20).attr("height",$).attr("width",R(N.fmax)-R(N.fmin)).on("click",()=>{dt(tt,ft(S),ht)}).datum({fmin:N.fmin,fmax:N.fmax})):c.includes(Z)&&(z=!0,Y.append("rect").attr("class","UTR").attr("x",R(N.fmin)).attr("transform",`translate(0,${A-b})`).attr("z-index",20).attr("height",A).attr("width",R(N.fmax)-R(N.fmin)).on("click",()=>{dt(tt,ft(S),ht)}).datum({fmin:N.fmin,fmax:N.fmax})),z){const _t=ca(i,1);rf(i),_t.forEach(I=>{const{type:pt,fmax:ct,fmin:W}=I;if(W<N.fmin&&ct>N.fmin||ct>N.fmax&&W<N.fmax||ct<=N.fmax&&W>=N.fmin){let wt=!0;const vt=zn(I),Q=Un(vt)[0],mt=Hn(vt),P=Math.max(Math.ceil(R(ct)-R(W)),m);if(pt.toLowerCase()==="deletion"||pt.toLowerCase()==="mnv"?Y.append("rect").attr("class","variant-deletion").attr("x",R(W)).attr("transform",`translate(0,${E-b})`).attr("z-index",30).attr("fill",Q).attr("height",y).attr("width",P).on("click",()=>{dt(tt,mt,ht)}).datum({fmin:W,fmax:ct}):pt.toLowerCase()==="snv"||pt.toLowerCase()==="point_mutation"?Y.append("polygon").attr("class","variant-SNV").attr("points",st(R(W))).attr("fill",Q).attr("x",R(W)).attr("transform",`translate(0,${E-b})`).attr("z-index",30).on("click",()=>{dt(tt,mt,ht)}).datum({fmin:W,fmax:ct}):pt.toLowerCase()==="insertion"?Y.append("polygon").attr("class","variant-insertion").attr("points",J(R(W))).attr("fill",Q).attr("x",R(W)).attr("transform",`translate(0,${E-b})`).attr("z-index",30).on("click",()=>{dt(tt,mt,ht)}).datum({fmin:W,fmax:ct}):pt.toLowerCase()==="delins"||pt.toLowerCase()==="substitution"||pt.toLowerCase()==="indel"?Y.append("polygon").attr("class","variant-delins").attr("points",at(R(W))).attr("x",R(W)).attr("transform",`translate(0,${E-b})`).attr("fill",Q).attr("z-index",30).on("click",()=>{dt(tt,mt,ht)}).datum({fmin:W,fmax:ct}):(console.warn("type not found",pt,I),wt=!1),wt&&o){const nt=be(I),rt=nt.length||1;Y.append("text").attr("class","variantLabel").attr("fill",xt?"sandybrown":Q).attr("opacity",xt?1:.5).attr("height",x).attr("transform",`translate(${R(W-rt/2*100)},${E*2.2-b})`).html(nt).on("click",()=>{dt(tt,mt,ht)}).datum({fmin:S.fmin})}}})}})),ut+=1}ut===T&&!qt&&(++X,qt=!0,At.append("a").attr("class","transcriptLabel").attr("xlink:show","new").append("text").attr("x",10).attr("y",10).attr("transform",`translate(0,${ut*g+20+kt})`).attr("fill","red").attr("opacity",1).attr("height",x).text("Maximum features displayed.  See full view for more."))}})}}return ut===0&&At.append("text").attr("x",30).attr("y",x+10).attr("fill","orange").attr("opacity",.6).text("Overview of non-coding genome features unavailable at this time."),ut*g+kt}filterVariantData(e,n){return n.length===0?e:e.filter(r=>n.includes(r.name))}renderTooltipDescription(e,n,r){e.transition().duration(200).style("width","auto").style("height","auto").style("opacity",1).style("visibility","visible"),e.html(n).style("left",`${window.event.pageX+10}px`).style("top",`${window.event.pageY+10}px`).append("button").attr("type","button").text("Close").on("click",()=>{r()}),e.append("button").attr("type","button").html("&times;").attr("class","tooltipDivX").on("click",()=>{r()})}}class uf{constructor({viewer:e,height:n,width:r,transcriptTypes:i,htpVariant:a,trackData:s,region:o,genome:c}){this.trackData=s??[],this.viewer=e,this.width=r,this.height=n,this.transcriptTypes=i,this.htpVariant=a,this.region=o,this.genome=c}renderTooltipDescription(e,n,r){e.transition().duration(200).style("width","auto").style("height","auto").style("opacity",1).style("visibility","visible"),e.html(n).style("left",`${window.event.pageX+10}px`).style("top",`${window.event.pageY+10}px`).append("button").attr("type","button").text("Close").on("click",()=>{r()}),e.append("button").attr("type","button").html("&times;").attr("class","tooltipDivX").on("click",()=>{r()})}DrawTrack(){var st;let e=this.trackData;const n=this.htpVariant,r=this.viewer,i=this.width,a=this.genome,s=(st=e[0])==null?void 0:st.seqId,o=10,c=["UTR","five_prime_UTR","three_prime_UTR"],l=["CDS"],f=["exon"],d=this.transcriptTypes,h=10,u=10,w=40,T=0,k=10,$=4,g=20,_=10,m=`0,0 0,${g} ${_},${_}`,x=this.renderTooltipDescription,A=Pt().domain([this.region.start,this.region.end]).range([0,i]),y={};for(let R=0,B=c.length;R<B;R++)y[c[R]]=200;for(let R=0,B=l.length;R<B;R++)y[l[R]]=1e3;for(let R=0,B=f.length;R<B;R++)y[f[R]]=100;e=e.sort((R,B)=>R.selected&&!B.selected?-1:!R.selected&&B.selected?1:R.name-B.name);const E=K("body").append("div").attr("class","gfc-tooltip").style("visibility","visible").style("opacity",0),b=()=>{E.transition().duration(100).style("opacity",10).style("visibility","hidden")};if(n){const R=r.append("g").attr("class","variants track").attr("transform","translate(0,22.5)"),[,B]=n.split(":");R.append("polygon").attr("class","variant-SNV").attr("points",cr(A(+B))).attr("fill","red").attr("x",A(+B)).attr("z-index",30)}const v=fe(this.viewer),p=r.append("g").attr("transform",`translate(0,${v})`).attr("class","track");let D=0;const M=[];let V=-1,J=-1;const at=[];for(let R=0;R<e.length&&D<o;R++){const B=e[R];let At=B.children;if(At){const L=B.selected;At=At.sort((F,kt)=>F.name<kt.name?-1:F.name>kt.name?1:0),At.forEach(F=>{var tt,ht;const kt=F.type;if(!at.includes(F.id)&&(at.push(F.id),d.includes(kt))){let ut=lr(M,A(F.fmin),A(F.fmax));if(D<o){const q=p.append("g").attr("class","isoform").attr("transform",`translate(0,${D*w+10})`),et=Math.max(A(F.fmin),0),Ft=Math.min(A(F.fmax),this.width);q.append("polygon").datum(()=>({strand:B.strand})).attr("class","transArrow").attr("points",m).attr("transform",()=>B.strand>0?`translate(${Ft},0)`:`translate(${et},${g}) rotate(180)`).on("click",()=>{x(E,ft(F),b)}),q.append("rect").attr("class","transcriptBackbone").attr("y",10+T).attr("height",$).attr("transform",`translate(${et},0)`).attr("width",Ft-et).datum({fmin:F.fmin,fmax:F.fmax}).on("click",()=>{x(E,ft(F),b)});let dt=F.name;B.name!==F.name&&(dt+=` (${B.name})`);let U=Math.max(A(F.fmin),0);const ot=q.append("svg:text").attr("class","transcriptLabel").attr("fill",L?"sandybrown":"gray").attr("opacity",L?1:.5).attr("height",T).attr("transform",`translate(${U},0)`).text(dt).datum({fmin:F.fmin}).on("click",()=>{x(E,ft(F),b)});let Rt=100;try{Rt=((tt=ot.node())==null?void 0:tt.getBBox().width)??0}catch{}if(Rt+U>this.width){const S=Rt+U-this.width;U-=S,ot.attr("transform",`translate(${U},0)`)}let xt=dt.length*2;try{xt=((ht=ot.node())==null?void 0:ht.getBBox().width)??0}catch(S){console.error("Not yet rendered",S)}Number(xt+A(F.fmin))>i;const qt=xt>A(F.fmax)-A(F.fmin)?A(F.fmin)+xt:A(F.fmax);if(M[ut]){const S=M[ut];S.push(`${A(F.fmin)}:${qt}`),M[ut]=S}else M[ut]=[`${A(F.fmin)}:${qt}`];(V<0||V>F.fmin)&&(V=F.fmin),(J<0||J<F.fmax)&&(J=F.fmax),F.children&&(F.children=F.children.sort(function(S,gt){const X=y[S.type],lt=y[gt.type];return typeof X=="number"&&typeof lt=="number"?X-lt:typeof X=="number"&&typeof lt!="number"?-1:typeof X!="number"&&typeof lt=="number"?1:S.type.localeCompare(gt.type)}),F.children.forEach(S=>{const gt=S.type;if(A(S.fmin)>this.width||A(S.fmax)<0)return;const X=Math.max(A(S.fmin),0),lt=Math.min(A(S.fmax),this.width);f.includes(gt)?q.append("rect").attr("class","exon").attr("x",X).attr("transform",`translate(0,${h-$})`).attr("height",h).attr("z-index",10).attr("width",lt-X).datum({fmin:S.fmin,fmax:S.fmax}).on("click",()=>{x(E,ft(F),b)}):l.includes(gt)?q.append("rect").attr("class","CDS").attr("x",X).attr("transform",`translate(0,${u-$})`).attr("z-index",20).attr("height",u).attr("width",lt-X).datum({fmin:S.fmin,fmax:S.fmax}).on("click",()=>{x(E,ft(F),b)}):c.includes(gt)&&q.append("rect").attr("class","UTR").attr("x",X).attr("transform",`translate(0,${k-$})`).attr("z-index",20).attr("height",k).attr("width",lt-X).datum({fmin:S.fmin,fmax:S.fmax}).on("click",()=>{x(E,ft(F),b)})})),D+=1}if(D===o){const q=ua(a,s,this.region.start,this.region.end);++ut,p.append("a").attr("class","transcriptLabel").attr("xlink:show","new").append("text").attr("x",10).attr("transform",`translate(0,${D*w+10})`).attr("fill","red").attr("opacity",1).attr("height",T).html(q)}}})}}return D===0&&p.append("text").attr("x",30).attr("y",T+10).attr("fill","orange").attr("opacity",.6).text("Overview of non-coding genome features unavailable at this time."),D*w}}class hf{constructor({viewer:e,track:n,height:r,width:i}){this.refSeq="",this.viewer=e,this.width=i,this.height=r,this.track=n}DrawScrollableTrack(){const e=this.viewer,n=this.refSeq,r=Pt().domain([this.track.start,this.track.end+1]).range(this.track.range),i=as(r).tickValues(this._getRefTick(this.track.start+1,this.track.end)).tickFormat((c,l)=>n[l]).tickSize(8).tickSizeInner(8).tickPadding(6),a=Math.floor(n.length/10),s=_r(r).ticks(a).tickValues(this._getRefTick(this.track.start+1,this.track.end,10));e.append("g").attr("class","axis x-local-axis track").attr("width",this.track.range[1]).attr("transform","translate(0, 20)").call(i),e.append("g").attr("class","axis x-local-numerical track").attr("width",this.track.range[1]).attr("transform","translate(0, 20)").call(s);const o=St(".x-local-numerical .tick text");o.first().attr("text-anchor","start"),o.last().attr("text-anchor","end"),St(".x-local-axis .tick text").each(function(){const l=K(this).text();let f="nucleotide nt-a";l==="T"?f="nucleotide nt-t":l==="C"?f="nucleotide nt-c":l==="G"&&(f="nucleotide nt-g"),K(this.parentNode).append("rect").attr("class",f).attr("transform","translate(-8,8)")})}DrawOverviewTrack(){const e=this.viewer,n=this.track.start,r=this.track.end,i=this.width,a=Pt().domain([n,r]).range(this.track.range),s=_r(a).ticks(8,"s").tickSize(8);e.append("g").attr("class","axis track").attr("width",i).attr("height",20).attr("transform","translate(0,20)").call(s)}_getRefTick(e,n,r){return r?new Array(Math.ceil((n-e+1)/10)).fill(0).map((i,a)=>e+a*10):new Array(n-e+1).fill(0).map((i,a)=>e+a)}async getTrackData(){}}const O={ISOFORM_EMBEDDED_VARIANT:"ISOFORM_EMBEDDED_VARIANT",ISOFORM_AND_VARIANT:"ISOFORM_AND_VARIANT",ISOFORM:"ISOFORM",VARIANT:"VARIANT",VARIANT_GLOBAL:"VARIANT_GLOBAL"};var Et="$";function nn(){}nn.prototype=ur.prototype={constructor:nn,has:function(t){return Et+t in this},get:function(t){return this[Et+t]},set:function(t,e){return this[Et+t]=e,this},remove:function(t){var e=Et+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Et&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Et&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Et&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Et&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Et&&++t;return t},empty:function(){for(var t in this)if(t[0]===Et)return!1;return!0},each:function(t){for(var e in this)e[0]===Et&&t(this[e],e.slice(1),this)}};function ur(t,e){var n=new nn;if(t instanceof nn)t.each(function(o,c){n.set(c,o)});else if(Array.isArray(t)){var r=-1,i=t.length,a;if(e==null)for(;++r<i;)n.set(r,t[r]);else for(;++r<i;)n.set(e(a=t[r],r,t),a)}else if(t)for(var s in t)n.set(s,t[s]);return n}function Ur(){}var Zt=ur.prototype;Ur.prototype={constructor:Ur,has:Zt.has,add:function(t){return t+="",this[Et+t]=t,this},remove:Zt.remove,clear:Zt.clear,values:Zt.keys,size:Zt.size,empty:Zt.empty,each:Zt.each};var qn="http://www.w3.org/1999/xhtml";const Pr={svg:"http://www.w3.org/2000/svg",xhtml:qn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ha(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Pr.hasOwnProperty(e)?{space:Pr[e],local:t}:t}function df(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===qn&&e.documentElement.namespaceURI===qn?e.createElement(t):e.createElementNS(n,t)}}function pf(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function da(t){var e=ha(t);return(e.local?pf:df)(e)}function mf(){}function pa(t){return t==null?mf:function(){return this.querySelector(t)}}function gf(t){typeof t!="function"&&(t=pa(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,o=r[i]=new Array(s),c,l,f=0;f<s;++f)(c=a[f])&&(l=t.call(c,c.__data__,f,a))&&("__data__"in c&&(l.__data__=c.__data__),o[f]=l);return new $t(r,this._parents)}function _f(){return[]}function wf(t){return t==null?_f:function(){return this.querySelectorAll(t)}}function yf(t){typeof t!="function"&&(t=wf(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var s=e[a],o=s.length,c,l=0;l<o;++l)(c=s[l])&&(r.push(t.call(c,c.__data__,l,s)),i.push(c));return new $t(r,i)}function xf(t){return function(){return this.matches(t)}}function vf(t){typeof t!="function"&&(t=xf(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],s=a.length,o=r[i]=[],c,l=0;l<s;++l)(c=a[l])&&t.call(c,c.__data__,l,a)&&o.push(c);return new $t(r,this._parents)}function ma(t){return new Array(t.length)}function bf(){return new $t(this._enter||this._groups.map(ma),this._parents)}function rn(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}rn.prototype={constructor:rn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function kf(t){return function(){return t}}var qr="$";function $f(t,e,n,r,i,a){for(var s=0,o,c=e.length,l=a.length;s<l;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new rn(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function Af(t,e,n,r,i,a,s){var o,c,l={},f=e.length,d=a.length,h=new Array(f),u;for(o=0;o<f;++o)(c=e[o])&&(h[o]=u=qr+s.call(c,c.__data__,o,e),u in l?i[o]=c:l[u]=c);for(o=0;o<d;++o)u=qr+s.call(t,a[o],o,a),(c=l[u])?(r[o]=c,c.__data__=a[o],l[u]=null):n[o]=new rn(t,a[o]);for(o=0;o<f;++o)(c=e[o])&&l[h[o]]===c&&(i[o]=c)}function Ef(t,e){if(!t)return u=new Array(this.size()),l=-1,this.each(function(A){u[++l]=A}),u;var n=e?Af:$f,r=this._parents,i=this._groups;typeof t!="function"&&(t=kf(t));for(var a=i.length,s=new Array(a),o=new Array(a),c=new Array(a),l=0;l<a;++l){var f=r[l],d=i[l],h=d.length,u=t.call(f,f&&f.__data__,l,r),w=u.length,T=o[l]=new Array(w),k=s[l]=new Array(w),$=c[l]=new Array(h);n(f,d,T,k,$,u,e);for(var g=0,_=0,m,x;g<w;++g)if(m=T[g]){for(g>=_&&(_=g+1);!(x=k[_])&&++_<w;);m._next=x||null}}return s=new $t(s,r),s._enter=o,s._exit=c,s}function Tf(){return new $t(this._exit||this._groups.map(ma),this._parents)}function Rf(t,e,n){var r=this.enter(),i=this,a=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(i=e(i)),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Sf(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),s=new Array(r),o=0;o<a;++o)for(var c=e[o],l=n[o],f=c.length,d=s[o]=new Array(f),h,u=0;u<f;++u)(h=c[u]||l[u])&&(d[u]=h);for(;o<r;++o)s[o]=e[o];return new $t(s,this._parents)}function Nf(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],s;--i>=0;)(s=r[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function Mf(t){t||(t=If);function e(d,h){return d&&h?t(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var s=n[a],o=s.length,c=i[a]=new Array(o),l,f=0;f<o;++f)(l=s[f])&&(c[f]=l);c.sort(e)}return new $t(i,this._parents).order()}function If(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Df(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Of(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function Lf(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null}function Ff(){var t=0;return this.each(function(){++t}),t}function Vf(){return!this.node()}function Bf(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,s=i.length,o;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this}function Cf(t){return function(){this.removeAttribute(t)}}function Hf(t){return function(){this.removeAttributeNS(t.space,t.local)}}function zf(t,e){return function(){this.setAttribute(t,e)}}function Uf(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Pf(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function qf(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Gf(t,e){var n=ha(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Hf:Cf:typeof e=="function"?n.local?qf:Pf:n.local?Uf:zf)(n,e))}function ga(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Wf(t){return function(){this.style.removeProperty(t)}}function Zf(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Xf(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Yf(t,e,n){return arguments.length>1?this.each((e==null?Wf:typeof e=="function"?Xf:Zf)(t,e,n??"")):Kf(this.node(),t)}function Kf(t,e){return t.style.getPropertyValue(e)||ga(t).getComputedStyle(t,null).getPropertyValue(e)}function Jf(t){return function(){delete this[t]}}function Qf(t,e){return function(){this[t]=e}}function jf(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function tu(t,e){return arguments.length>1?this.each((e==null?Jf:typeof e=="function"?jf:Qf)(t,e)):this.node()[t]}function _a(t){return t.trim().split(/^|\s+/)}function hr(t){return t.classList||new wa(t)}function wa(t){this._node=t,this._names=_a(t.getAttribute("class")||"")}wa.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function ya(t,e){for(var n=hr(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function xa(t,e){for(var n=hr(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function eu(t){return function(){ya(this,t)}}function nu(t){return function(){xa(this,t)}}function ru(t,e){return function(){(e.apply(this,arguments)?ya:xa)(this,t)}}function iu(t,e){var n=_a(t+"");if(arguments.length<2){for(var r=hr(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?ru:e?eu:nu)(n,e))}function au(){this.textContent=""}function su(t){return function(){this.textContent=t}}function ou(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function lu(t){return arguments.length?this.each(t==null?au:(typeof t=="function"?ou:su)(t)):this.node().textContent}function cu(){this.innerHTML=""}function fu(t){return function(){this.innerHTML=t}}function uu(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function hu(t){return arguments.length?this.each(t==null?cu:(typeof t=="function"?uu:fu)(t)):this.node().innerHTML}function du(){this.nextSibling&&this.parentNode.appendChild(this)}function pu(){return this.each(du)}function mu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gu(){return this.each(mu)}function _u(t){var e=typeof t=="function"?t:da(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function wu(){return null}function yu(t,e){var n=typeof t=="function"?t:da(t),r=e==null?wu:typeof e=="function"?e:pa(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function xu(){var t=this.parentNode;t&&t.removeChild(this)}function vu(){return this.each(xu)}function bu(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ku(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function $u(t){return this.select(t?ku:bu)}function Au(t){return arguments.length?this.property("__data__",t):this.node().__data__}var va={};if(typeof document<"u"){var Eu=document.documentElement;"onmouseenter"in Eu||(va={mouseenter:"mouseover",mouseleave:"mouseout"})}function Tu(t,e,n){return t=ba(t,e,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&t.call(this,r)}}function ba(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function Ru(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Su(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.capture):e[++r]=a;++r?e.length=r:delete this.__on}}}function Nu(t,e,n){var r=va.hasOwnProperty(t.type)?Tu:ba;return function(i,a,s){var o=this.__on,c,l=r(e,a,s);if(o){for(var f=0,d=o.length;f<d;++f)if((c=o[f]).type===t.type&&c.name===t.name){this.removeEventListener(c.type,c.listener,c.capture),this.addEventListener(c.type,c.listener=l,c.capture=n),c.value=e;return}}this.addEventListener(t.type,l,n),c={type:t.type,name:t.name,value:e,listener:l,capture:n},o?o.push(c):this.__on=[c]}}function Mu(t,e,n){var r=Ru(t+""),i,a=r.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,l=o.length,f;c<l;++c)for(i=0,f=o[c];i<a;++i)if((s=r[i]).type===f.type&&s.name===f.name)return f.value}return}for(o=e?Nu:Su,n==null&&(n=!1),i=0;i<a;++i)this.each(o(r[i],e,n));return this}function ka(t,e,n){var r=ga(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Iu(t,e){return function(){return ka(this,t,e)}}function Du(t,e){return function(){return ka(this,t,e.apply(this,arguments))}}function Ou(t,e){return this.each((typeof e=="function"?Du:Iu)(t,e))}var $a=[null];function $t(t,e){this._groups=t,this._parents=e}function Gn(){return new $t([[document.documentElement]],$a)}$t.prototype=Gn.prototype={constructor:$t,select:gf,selectAll:yf,filter:vf,data:Ef,enter:bf,exit:Tf,join:Rf,merge:Sf,order:Nf,sort:Mf,call:Df,nodes:Of,node:Lf,size:Ff,empty:Vf,each:Bf,attr:Gf,style:Yf,property:tu,classed:iu,text:lu,html:hu,raise:pu,lower:gu,append:_u,insert:yu,remove:vu,clone:$u,datum:Au,on:Mu,dispatch:Ou};function Gr(t){return typeof t=="string"?new $t([[document.querySelector(t)]],[document.documentElement]):new $t([[t]],$a)}function Lu(){var t=l,e=f,n=d,r=document.body,i=A(),a=null,s=null,o=null;function c(p){a=y(p),a&&(s=a.createSVGPoint(),r.appendChild(i))}c.show=function(){var p=Array.prototype.slice.call(arguments);p[p.length-1]instanceof SVGElement&&(o=p.pop());var D=n.apply(this,p),M=e.apply(this,p),V=t.apply(this,p),J=E(),at=u.length,st,R=document.documentElement.scrollTop||r.scrollTop,B=document.documentElement.scrollLeft||r.scrollLeft;for(J.html(D).style("opacity",1).style("pointer-events","all");at--;)J.classed(u[at],!1);return st=h.get(V).apply(this),J.classed(V,!0).style("top",st.top+M[0]+R+"px").style("left",st.left+M[1]+B+"px"),c},c.hide=function(){var p=E();return p.style("opacity",0).style("pointer-events","none"),c},c.attr=function(p,D){if(arguments.length<2&&typeof p=="string")return E().attr(p);var M=Array.prototype.slice.call(arguments);return Gn.prototype.attr.apply(E(),M),c},c.style=function(p,D){if(arguments.length<2&&typeof p=="string")return E().style(p);var M=Array.prototype.slice.call(arguments);return Gn.prototype.style.apply(E(),M),c},c.direction=function(p){return arguments.length?(t=p==null?p:v(p),c):t},c.offset=function(p){return arguments.length?(e=p==null?p:v(p),c):e},c.html=function(p){return arguments.length?(n=p==null?p:v(p),c):n},c.rootElement=function(p){return arguments.length?(r=p==null?p:v(p),c):r},c.destroy=function(){return i&&(E().remove(),i=null),c};function l(){return"n"}function f(){return[0,0]}function d(){return" "}var h=ur({n:w,s:T,e:k,w:$,nw:g,ne:_,sw:m,se:x}),u=h.keys();function w(){var p=b(this);return{top:p.n.y-i.offsetHeight,left:p.n.x-i.offsetWidth/2}}function T(){var p=b(this);return{top:p.s.y,left:p.s.x-i.offsetWidth/2}}function k(){var p=b(this);return{top:p.e.y-i.offsetHeight/2,left:p.e.x}}function $(){var p=b(this);return{top:p.w.y-i.offsetHeight/2,left:p.w.x-i.offsetWidth}}function g(){var p=b(this);return{top:p.nw.y-i.offsetHeight,left:p.nw.x-i.offsetWidth}}function _(){var p=b(this);return{top:p.ne.y-i.offsetHeight,left:p.ne.x}}function m(){var p=b(this);return{top:p.sw.y,left:p.sw.x-i.offsetWidth}}function x(){var p=b(this);return{top:p.se.y,left:p.se.x}}function A(){var p=Gr(document.createElement("div"));return p.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),p.node()}function y(p){var D=p.node();return D?D.tagName.toLowerCase()==="svg"?D:D.ownerSVGElement:null}function E(){return i==null&&(i=A(),r.appendChild(i)),Gr(i)}function b(p){for(var D=o||p;D.getScreenCTM==null&&D.parentNode!=null;)D=D.parentNode;var M={},V=D.getScreenCTM(),J=D.getBBox(),at=J.width,st=J.height,R=J.x,B=J.y;return s.x=R,s.y=B,M.nw=s.matrixTransform(V),s.x+=at,M.ne=s.matrixTransform(V),s.y+=st,M.se=s.matrixTransform(V),s.x-=at,M.sw=s.matrixTransform(V),s.y-=st/2,M.w=s.matrixTransform(V),s.x+=at,M.e=s.matrixTransform(V),s.x-=at/2,s.y-=st/2,M.n=s.matrixTransform(V),s.y+=st,M.s=s.matrixTransform(V),M}function v(p){return typeof p=="function"?p:function(){return p}}return c}class Fu{constructor({region:e,viewer:n,height:r,width:i,range:a}){this.variants=[],this.viewer=n,this.width=i,this.height=r,this.region=e,this.range=a}DrawTrack(){const e=this.viewer,n=this.variants,r=Pt().domain([this.region.start,this.region.end+1]).range(this.range),i=ia().type(ra).size(20),a=Lu();a.attr("class","d3-tip").html(d=>`<table><th colspan="2">${"Case Variant".toUpperCase()}</th><tr><td>Position</td> <td>${d.position}</td></tr><tr><td>Mutation</td> <td>${d.ref} > ${d.mutant}</td></tr></table>`).offset([10,0]).direction("s"),e.call(a);const s=20,o=fe(this.viewer),c=e.append("g").attr("transform",`translate(0,${o})`).attr("class","track");c.append("rect").attr("height",s).attr("width",-this.range[0]+this.range[1]).attr("fill-opacity",.1).attr("fill","rgb(148, 140, 140)").attr("stroke-width",0).attr("stroke-opacity",0).attr("transform",`translate(${this.range[0]},0)`),c.selectAll("path").data(n).enter().append("path").attr("d",i).attr("class","case-variant").attr("stroke","red").attr("fill","red").attr("transform",d=>`translate(${r(d.position)},10)`).on("mouseenter",a.show).on("mouseout",a.hide);const f=K("#viewer2").append("g").attr("transform",`translate(25,${o})`).attr("class","track-label");f.append("line").attr("x1",75).attr("y1",0).attr("x2",75).attr("y2",s).attr("stroke-width",3).attr("stroke","#609C9C"),f.append("text").text(this.track.label.toUpperCase()).attr("y",12)}async getTrackData(){}}class Vu{constructor({viewer:e,track:n,height:r,width:i,region:a}){this.variants=[],this.region=a,this.viewer=e,this.width=i,this.height=r,this.track=n}DrawTrack(){const e=this.viewer,n=this.variants,r=Pt().domain([this.region.start,this.region.end]).range(this.track.range),i=ia().type(ra).size(20),a=20,s=fe(this.viewer),o=e.append("g").attr("transform",`translate(0,${s})`).attr("class","track");o.append("rect").attr("height",a).attr("width",-this.track.range[0]+this.track.range[1]).attr("fill-opacity",.1).attr("fill","rgb(148, 140, 140)").attr("stroke-width",0).attr("stroke-opacity",0),o.selectAll("path").data(n).enter().append("path").attr("d",i).attr("class","global-variant").attr("stroke","red").attr("fill","red").attr("transform",c=>`translate(${r(c.position)},10)`)}async getTrackData(){}}function Aa(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yn,Wr;function Bu(){if(Wr)return yn;Wr=1;class t{constructor(n={}){if(!(n.maxSize&&n.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=n.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(n,r){this.cache.set(n,r),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(n){if(this.cache.has(n))return this.cache.get(n);if(this.oldCache.has(n)){const r=this.oldCache.get(n);return this.oldCache.delete(n),this._set(n,r),r}}set(n,r){return this.cache.has(n)?this.cache.set(n,r):this._set(n,r),this}has(n){return this.cache.has(n)||this.oldCache.has(n)}peek(n){if(this.cache.has(n))return this.cache.get(n);if(this.oldCache.has(n))return this.oldCache.get(n)}delete(n){const r=this.cache.delete(n);return r&&this._size--,this.oldCache.delete(n)||r}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[n]of this)yield n}*values(){for(const[,n]of this)yield n}*[Symbol.iterator](){for(const n of this.cache)yield n;for(const n of this.oldCache){const[r]=n;this.cache.has(r)||(yield n)}}get size(){let n=0;for(const r of this.oldCache.keys())this.cache.has(r)||n++;return this._size+n}}return yn=t,yn}var Cu=Bu();const dr=Aa(Cu);class Hu{}class zu{constructor(){this.signals=new Set,this.abortController=new AbortController}addSignal(e=new Hu){if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(e),e.aborted?this.handleAborted(e):typeof e.addEventListener=="function"&&e.addEventListener("abort",()=>{this.handleAborted(e)})}handleAborted(e){this.signals.delete(e),this.signals.size===0&&this.abortController.abort()}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}}class Uu{constructor(){this.callbacks=new Set}addCallback(e=()=>{}){this.callbacks.add(e),e(this.currentMessage)}callback(e){this.currentMessage=e;for(const n of this.callbacks)n(e)}}class ue{constructor({fill:e,cache:n}){if(typeof e!="function")throw new TypeError("must pass a fill function");if(typeof n!="object")throw new TypeError("must pass a cache object");if(typeof n.get!="function"||typeof n.set!="function"||typeof n.delete!="function")throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=n,this.fillCallback=e}static isAbortException(e){return e.name==="AbortError"||e.code==="ERR_ABORTED"||e.message==="AbortError: aborted"||e.message==="Error: aborted"}evict(e,n){this.cache.get(e)===n&&this.cache.delete(e)}fill(e,n,r,i){const a=new zu,s=new Uu;s.addCallback(i);const o={aborter:a,promise:this.fillCallback(n,a.signal,c=>{s.callback(c)}),settled:!1,statusReporter:s,get aborted(){return this.aborter.signal.aborted}};o.aborter.addSignal(r),o.aborter.signal.addEventListener("abort",()=>{o.settled||this.evict(e,o)}),o.promise.then(()=>{o.settled=!0},()=>{o.settled=!0,this.evict(e,o)}).catch(c=>{throw console.error(c),c}),this.cache.set(e,o)}static checkSinglePromise(e,n){function r(){if(n!=null&&n.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return e.then(i=>(r(),i),i=>{throw r(),i})}has(e){return this.cache.has(e)}get(e,n,r,i){if(!r&&n instanceof AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");const a=this.cache.get(e);return a?a.aborted&&!a.settled?(this.evict(e,a),this.get(e,n,r,i)):a.settled?a.promise:(a.aborter.addSignal(r),a.statusReporter.addCallback(i),ue.checkSinglePromise(a.promise,r)):(this.fill(e,n,r,i),ue.checkSinglePromise(this.cache.get(e).promise,r))}delete(e){const n=this.cache.get(e);n&&(n.settled||n.aborter.abort(),this.cache.delete(e))}clear(){const e=this.cache.keys();let n=0;for(let r=e.next();!r.done;r=e.next())this.delete(r.value),n+=1;return n}}var Ge={exports:{}},Pu=Ge.exports,Zr;function qu(){return Zr||(Zr=1,function(t,e){(function(n,r){t.exports=r()})(Pu,function(){const n=/^[\w+.-]+:\/\//,r=/^([\w+.-]+:)\/\/([^@/#?]*@)?([^:/#?]*)(:\d+)?(\/[^#?]*)?(\?[^#]*)?(#.*)?/,i=/^file:(?:\/\/((?![a-z]:)[^/#?]*)?)?(\/?[^#?]*)(\?[^#]*)?(#.*)?/i;function a(g){return n.test(g)}function s(g){return g.startsWith("//")}function o(g){return g.startsWith("/")}function c(g){return g.startsWith("file:")}function l(g){return/^[.?#]/.test(g)}function f(g){const _=r.exec(g);return h(_[1],_[2]||"",_[3],_[4]||"",_[5]||"/",_[6]||"",_[7]||"")}function d(g){const _=i.exec(g),m=_[2];return h("file:","",_[1]||"","",o(m)?m:"/"+m,_[3]||"",_[4]||"")}function h(g,_,m,x,A,y,E){return{scheme:g,user:_,host:m,port:x,path:A,query:y,hash:E,type:7}}function u(g){if(s(g)){const m=f("http:"+g);return m.scheme="",m.type=6,m}if(o(g)){const m=f("http://foo.com"+g);return m.scheme="",m.host="",m.type=5,m}if(c(g))return d(g);if(a(g))return f(g);const _=f("http://foo.com/"+g);return _.scheme="",_.host="",_.type=g?g.startsWith("?")?3:g.startsWith("#")?2:4:1,_}function w(g){if(g.endsWith("/.."))return g;const _=g.lastIndexOf("/");return g.slice(0,_+1)}function T(g,_){k(_,_.type),g.path==="/"?g.path=_.path:g.path=w(_.path)+g.path}function k(g,_){const m=_<=4,x=g.path.split("/");let A=1,y=0,E=!1;for(let v=1;v<x.length;v++){const p=x[v];if(!p){E=!0;continue}if(E=!1,p!=="."){if(p===".."){y?(E=!0,y--,A--):m&&(x[A++]=p);continue}x[A++]=p,y++}}let b="";for(let v=1;v<A;v++)b+="/"+x[v];(!b||E&&!b.endsWith("/.."))&&(b+="/"),g.path=b}function $(g,_){if(!g&&!_)return"";const m=u(g);let x=m.type;if(_&&x!==7){const y=u(_),E=y.type;switch(x){case 1:m.hash=y.hash;case 2:m.query=y.query;case 3:case 4:T(m,y);case 5:m.user=y.user,m.host=y.host,m.port=y.port;case 6:m.scheme=y.scheme}E>x&&(x=E)}k(m,x);const A=m.query+m.hash;switch(x){case 2:case 3:return A;case 4:{const y=m.path.slice(1);return y?l(_||g)&&!l(y)?"./"+y+A:y+A:A||"."}case 5:return m.path+A;default:return m.scheme+"//"+m.user+m.host+m.port+m.path+A}}return $})}(Ge)),Ge.exports}var Gu=qu();const Wu=Aa(Gu);async function pr(t,e,n={}){const{defaultContent:r={}}=n;try{const i=await e(t,{encoding:"utf8"}),a=new TextDecoder("utf8");return JSON.parse(a.decode(i))}catch(i){if(i.code==="ENOENT"||i.status===404||i.message.includes("404")||i.message.includes("ENOENT"))return r;throw i}}function mr(t,e="."){return Wu(t,e)}class Zu{constructor({readFile:e,cacheSize:n=100}){if(this.topList=[],this.chunkCache=new ue({cache:new dr({maxSize:n}),fill:this.readChunkItems.bind(this)}),this.readFile=e,!this.readFile)throw new Error('must provide a "readFile" function')}importExisting(e,n,r,i,a){this.topList=e,this.attrs=n,this.start=n.makeFastGetter("Start"),this.end=n.makeFastGetter("End"),this.lazyClass=a,this.baseURL=r,this.lazyUrlTemplate=i}binarySearch(e,n,r){let i=-1,a=e.length,s;for(;a-i>1;)s=i+a>>>1,r(e[s])>=n?a=s:i=s;return r===this.end?a:i}readChunkItems(e){const n=mr(this.lazyUrlTemplate.replaceAll(/\{Chunk\}/gi,e),this.baseURL);return pr(n,this.readFile,{defaultContent:[]})}async*iterateSublist(e,n,r,i,a,s,o){const c=this.attrs.makeGetter("Chunk"),l=this.attrs.makeGetter("Sublist"),f=[];for(let d=this.binarySearch(e,n,a);d<e.length&&d>=0&&i*s(e[d])<i*r;d+=i){if(e[d][0]===this.lazyClass){const u=c(e[d]),w=this.chunkCache.get(u,u).then(T=>[T,u]);f.push(w)}else yield[e[d],o.concat(d)];const h=l(e[d]);h&&(yield*this.iterateSublist(h,n,r,i,a,s,o.concat(d)))}for(const d of f){const[h,u]=await d;h&&(yield*this.iterateSublist(h,n,r,i,a,s,[...o,u]))}}async*iterate(e,n){const r=e>n?-1:1,i=e>n?this.start:this.end,a=e>n?this.end:this.start;this.topList.length>0&&(yield*this.iterateSublist(this.topList,e,n,r,i,a,[0]))}async histogram(e,n,r){const i=new Array(r);i.fill(0);const a=(n-e)/r;for await(const s of this.iterate(e,n)){const o=Math.max(0,(this.start(s)-e)/a|0),c=Math.min(r,(this.end(s)-e)/a|0);for(let l=o;l<=c;l+=1)i[l]+=1}return i}}class Xu{constructor(e){this.classes=e,this.fields=[];for(let n=0;n<e.length;n+=1){this.fields[n]={};for(let r=0;r<e[n].attributes.length;r+=1)this.fields[n][e[n].attributes[r]]=r+1;e[n].proto===void 0&&(e[n].proto={}),e[n].isArrayAttr===void 0&&(e[n].isArrayAttr={})}}attrIndices(e){return this.classes.map(n=>n.attributes.indexOf(e)+1||n.attributes.indexOf(e.toLowerCase())+1||void 0)}get(e,n){if(n in this.fields[e[0]])return e[this.fields[e[0]][n]];const r=n.toLowerCase();if(r in this.fields[e[0]])return e[this.fields[e[0]][r]];const i=this.classes[e[0]].attributes.length+1;return i>=e.length||!(n in e[i])?n in this.classes[e[0]].proto?this.classes[e[0]].proto[n]:void 0:e[i][n]}makeSetter(e){return(n,r)=>{this.set(n,e,r)}}makeGetter(e){return n=>this.get(n,e)}makeFastGetter(e){const n=this.attrIndices(e);return function(i){if(n[i[0]]!==void 0)return i[n[i[0]]]}}accessors(){return this._accessors||(this._accessors=this._makeAccessors()),this._accessors}_makeAccessors(){const e={},n={get(i){const a=this.get.field_accessors[i.toLowerCase()];if(a)return a.call(this)},set(i,a){const s=this.set.field_accessors[i];if(s)return s.call(this,a)},tags(){return r[this[0]]||[]}};n.get.field_accessors={},n.set.field_accessors={},this.classes.forEach((i,a)=>{(i.attributes||[]).forEach((s,o)=>{e[s]=e[s]||[],e[s][a]=o+1,s=s.toLowerCase(),e[s]=e[s]||[],e[s][a]=o+1})});const r=this.classes.map(i=>i.attributes);return Object.keys(e).forEach(i=>{const a=e[i];n.get.field_accessors[i]=a?function(){return this[a[this[0]]]}:function(){}}),n}}class Yu{constructor({urlTemplate:e,chunkSize:n,length:r,cacheSize:i=100,readFile:a},s){if(this.urlTemplate=e,this.chunkSize=n,this.length=r,this.baseUrl=s===void 0?"":s,this.readFile=a,!a)throw new Error("must provide readFile callback");this.chunkCache=new ue({cache:new dr({maxSize:i}),fill:this.getChunk.bind(this)})}index(e,n,r){this.range(e,e,n,void 0,r)}async*range(e,n){e=Math.max(0,e),n=Math.min(n,this.length-1);const r=Math.floor(e/this.chunkSize),i=Math.floor(n/this.chunkSize),a=[];for(let s=r;s<=i;s+=1)a.push(this.chunkCache.get(s,s));for(const s of a){const[o,c]=await s;yield*this.filterChunkData(e,n,o,c)}}async getChunk(e){let n=this.urlTemplate.replaceAll(/\{Chunk\}/gi,e);this.baseUrl&&(n=mr(n,this.baseUrl));const r=await pr(n,this.readFile);return[e,r]}*filterChunkData(e,n,r,i){const a=r*this.chunkSize,s=Math.max(0,e-a),o=Math.min(n-a,this.chunkSize-1);for(let c=s;c<=o;c+=1)yield[c+a,i[c]]}}function Ku(){return this._uniqueID}function Ju(){return this._parent}function Qu(){return this.get("subfeatures")}class ju{constructor({baseUrl:e,urlTemplate:n,readFile:r,cacheSize:i=10}){if(this.baseUrl=e,this.urlTemplates={root:n},this.readFile=r,!this.readFile)throw new Error('must provide a "readFile" function argument');this.dataRootCache=new ue({cache:new dr({maxSize:i}),fill:this.fetchDataRoot.bind(this)})}makeNCList(){return new Zu({readFile:this.readFile})}loadNCList(e,n,r){e.nclist.importExisting(n.intervals.nclist,e.attrs,r,n.intervals.urlTemplate,n.intervals.lazyClass)}getDataRoot(e){return this.dataRootCache.get(e,e)}fetchDataRoot(e){const n=mr(this.urlTemplates.root.replaceAll(/{\s*refseq\s*}/g,e),this.baseUrl);return pr(n,this.readFile).then(r=>this.parseTrackInfo(r,n))}parseTrackInfo(e,n){const r={nclist:this.makeNCList(),stats:{featureCount:e.featureCount||0}};e.intervals&&(r.attrs=new Xu(e.intervals.classes),this.loadNCList(r,e,n));const{histograms:i}=e;if(i!=null&&i.meta){for(let a=0;a<i.meta.length;a+=1)i.meta[a].lazyArray=new Yu({...i.meta[a].arrayParams,readFile:this.readFile},n);r._histograms=i}return r._histograms&&Object.keys(r._histograms).forEach(a=>{r._histograms[a].forEach(o=>{Object.keys(o).forEach(c=>{typeof o[c]=="string"&&String(Number(o[c]))===o[c]&&(o[c]=Number(o[c]))})})}),r}async getRegionStats(e){return(await this.getDataRoot(e.ref)).stats}async getRegionFeatureDensities({refName:e,start:n,end:r,numBins:i,basesPerBin:a}){const s=await this.getDataRoot(e);if(i)a=(r-n)/i;else if(a)i=Math.ceil((r-n)/a);else throw new TypeError("numBins or basesPerBin arg required for getRegionFeatureDensities");const c=(s._histograms.stats||[]).find(h=>h.basesPerBin>=a);let l=s._histograms.meta[0];for(let h=0;h<s._histograms.meta.length;h+=1)a>=s._histograms.meta[h].basesPerBin&&(l=s._histograms.meta[h]);let f=a/l.basesPerBin;if(f>.9&&Math.abs(f-Math.round(f))<1e-4){const h=Math.floor(n/l.basesPerBin);f=Math.round(f);const u=[];for(let w=0;w<i;w+=1)u[w]=0;for await(const[w,T]of l.lazyArray.range(h,h+f*i-1))u[Math.floor((w-h)/f)]+=T;return{bins:u,stats:c}}return{bins:await s.nclist.histogram(n,r,i),stats:c}}async*getFeatures({refName:e,start:n,end:r}){var s;const i=await this.getDataRoot(e),a=(s=i.attrs)==null?void 0:s.accessors();for await(const[o,c]of i.nclist.iterate(n,r)){if(!o.decorated){const l=c.join(",");this.decorateFeature(a,o,`${e},${l}`)}yield o}}decorateFeature(e,n,r,i){n.get=e.get,n.tags=e.tags,n._uniqueID=r,n.id=Ku,n._parent=i,n.parent=Ju,n.children=Qu,(n.get("subfeatures")||[]).forEach((a,s)=>{this.decorateFeature(e,a,`${r}-${s}`,n)}),n.decorated=!0}}function de(t){let e=t.length;for(;--e>=0;)t[e]=0}const th=3,eh=258,Ea=29,nh=256,rh=nh+1+Ea,Ta=30,ih=512,ah=new Array((rh+2)*2);de(ah);const sh=new Array(Ta*2);de(sh);const oh=new Array(ih);de(oh);const lh=new Array(eh-th+1);de(lh);const ch=new Array(Ea);de(ch);const fh=new Array(Ta);de(fh);const uh=(t,e,n,r)=>{let i=t&65535|0,a=t>>>16&65535|0,s=0;for(;n!==0;){s=n>2e3?2e3:n,n-=s;do i=i+e[r++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16|0};var Wn=uh;const hh=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},dh=new Uint32Array(hh()),ph=(t,e,n,r)=>{const i=dh,a=r+n;t^=-1;for(let s=r;s<a;s++)t=t>>>8^i[(t^e[s])&255];return t^-1};var Dt=ph,Zn={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ra={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const mh=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var gh=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)mh(n,r)&&(t[r]=n[r])}}return t},_h=t=>{let e=0;for(let r=0,i=t.length;r<i;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,i=0,a=t.length;r<a;r++){let s=t[r];n.set(s,i),i+=s.length}return n},Sa={assign:gh,flattenChunks:_h};let Na=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Na=!1}const ke=new Uint8Array(256);for(let t=0;t<256;t++)ke[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ke[254]=ke[254]=1;var wh=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,r,i,a,s=t.length,o=0;for(i=0;i<s;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<s&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(o),a=0,i=0;a<o;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<s&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|n&63):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|n&63):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|n&63);return e};const yh=(t,e)=>{if(e<65534&&t.subarray&&Na)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n};var xh=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let r,i;const a=new Array(n*2);for(i=0,r=0;r<n;){let s=t[r++];if(s<128){a[i++]=s;continue}let o=ke[s];if(o>4){a[i++]=65533,r+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&r<n;)s=s<<6|t[r++]&63,o--;if(o>1){a[i++]=65533;continue}s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|s&1023)}return yh(a,i)},vh=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+ke[t[n]]>e?n:e},Xn={string2buf:wh,buf2string:xh,utf8border:vh};function bh(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var kh=bh;const Le=16209,$h=16191;var Ah=function(e,n){let r,i,a,s,o,c,l,f,d,h,u,w,T,k,$,g,_,m,x,A,y,E,b,v;const p=e.state;r=e.next_in,b=e.input,i=r+(e.avail_in-5),a=e.next_out,v=e.output,s=a-(n-e.avail_out),o=a+(e.avail_out-257),c=p.dmax,l=p.wsize,f=p.whave,d=p.wnext,h=p.window,u=p.hold,w=p.bits,T=p.lencode,k=p.distcode,$=(1<<p.lenbits)-1,g=(1<<p.distbits)-1;t:do{w<15&&(u+=b[r++]<<w,w+=8,u+=b[r++]<<w,w+=8),_=T[u&$];e:for(;;){if(m=_>>>24,u>>>=m,w-=m,m=_>>>16&255,m===0)v[a++]=_&65535;else if(m&16){x=_&65535,m&=15,m&&(w<m&&(u+=b[r++]<<w,w+=8),x+=u&(1<<m)-1,u>>>=m,w-=m),w<15&&(u+=b[r++]<<w,w+=8,u+=b[r++]<<w,w+=8),_=k[u&g];n:for(;;){if(m=_>>>24,u>>>=m,w-=m,m=_>>>16&255,m&16){if(A=_&65535,m&=15,w<m&&(u+=b[r++]<<w,w+=8,w<m&&(u+=b[r++]<<w,w+=8)),A+=u&(1<<m)-1,A>c){e.msg="invalid distance too far back",p.mode=Le;break t}if(u>>>=m,w-=m,m=a-s,A>m){if(m=A-m,m>f&&p.sane){e.msg="invalid distance too far back",p.mode=Le;break t}if(y=0,E=h,d===0){if(y+=l-m,m<x){x-=m;do v[a++]=h[y++];while(--m);y=a-A,E=v}}else if(d<m){if(y+=l+d-m,m-=d,m<x){x-=m;do v[a++]=h[y++];while(--m);if(y=0,d<x){m=d,x-=m;do v[a++]=h[y++];while(--m);y=a-A,E=v}}}else if(y+=d-m,m<x){x-=m;do v[a++]=h[y++];while(--m);y=a-A,E=v}for(;x>2;)v[a++]=E[y++],v[a++]=E[y++],v[a++]=E[y++],x-=3;x&&(v[a++]=E[y++],x>1&&(v[a++]=E[y++]))}else{y=a-A;do v[a++]=v[y++],v[a++]=v[y++],v[a++]=v[y++],x-=3;while(x>2);x&&(v[a++]=v[y++],x>1&&(v[a++]=v[y++]))}}else if(m&64){e.msg="invalid distance code",p.mode=Le;break t}else{_=k[(_&65535)+(u&(1<<m)-1)];continue n}break}}else if(m&64)if(m&32){p.mode=$h;break t}else{e.msg="invalid literal/length code",p.mode=Le;break t}else{_=T[(_&65535)+(u&(1<<m)-1)];continue e}break}}while(r<i&&a<o);x=w>>3,r-=x,w-=x<<3,u&=(1<<w)-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=a<o?257+(o-a):257-(a-o),p.hold=u,p.bits=w};const ie=15,Xr=852,Yr=592,Kr=0,xn=1,Jr=2,Eh=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Th=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Rh=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Sh=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Nh=(t,e,n,r,i,a,s,o)=>{const c=o.bits;let l=0,f=0,d=0,h=0,u=0,w=0,T=0,k=0,$=0,g=0,_,m,x,A,y,E=null,b;const v=new Uint16Array(ie+1),p=new Uint16Array(ie+1);let D=null,M,V,J;for(l=0;l<=ie;l++)v[l]=0;for(f=0;f<r;f++)v[e[n+f]]++;for(u=c,h=ie;h>=1&&v[h]===0;h--);if(u>h&&(u=h),h===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,o.bits=1,0;for(d=1;d<h&&v[d]===0;d++);for(u<d&&(u=d),k=1,l=1;l<=ie;l++)if(k<<=1,k-=v[l],k<0)return-1;if(k>0&&(t===Kr||h!==1))return-1;for(p[1]=0,l=1;l<ie;l++)p[l+1]=p[l]+v[l];for(f=0;f<r;f++)e[n+f]!==0&&(s[p[e[n+f]]++]=f);if(t===Kr?(E=D=s,b=20):t===xn?(E=Eh,D=Th,b=257):(E=Rh,D=Sh,b=0),g=0,f=0,l=d,y=a,w=u,T=0,x=-1,$=1<<u,A=$-1,t===xn&&$>Xr||t===Jr&&$>Yr)return 1;for(;;){M=l-T,s[f]+1<b?(V=0,J=s[f]):s[f]>=b?(V=D[s[f]-b],J=E[s[f]-b]):(V=96,J=0),_=1<<l-T,m=1<<w,d=m;do m-=_,i[y+(g>>T)+m]=M<<24|V<<16|J|0;while(m!==0);for(_=1<<l-1;g&_;)_>>=1;if(_!==0?(g&=_-1,g+=_):g=0,f++,--v[l]===0){if(l===h)break;l=e[n+s[f]]}if(l>u&&(g&A)!==x){for(T===0&&(T=u),y+=d,w=l-T,k=1<<w;w+T<h&&(k-=v[w+T],!(k<=0));)w++,k<<=1;if($+=1<<w,t===xn&&$>Xr||t===Jr&&$>Yr)return 1;x=g&A,i[x]=u<<24|w<<16|y-a|0}}return g!==0&&(i[y+g]=l-T<<24|64<<16|0),o.bits=u,0};var we=Nh;const Mh=0,Ma=1,Ia=2,{Z_FINISH:Qr,Z_BLOCK:Ih,Z_TREES:Fe,Z_OK:te,Z_STREAM_END:Dh,Z_NEED_DICT:Oh,Z_STREAM_ERROR:Tt,Z_DATA_ERROR:Da,Z_MEM_ERROR:Oa,Z_BUF_ERROR:Lh,Z_DEFLATED:jr}=Ra,un=16180,ti=16181,ei=16182,ni=16183,ri=16184,ii=16185,ai=16186,si=16187,oi=16188,li=16189,an=16190,Bt=16191,vn=16192,ci=16193,bn=16194,fi=16195,ui=16196,hi=16197,di=16198,Ve=16199,Be=16200,pi=16201,mi=16202,gi=16203,_i=16204,wi=16205,kn=16206,yi=16207,xi=16208,j=16209,La=16210,Fa=16211,Fh=852,Vh=592,Bh=15,Ch=Bh,vi=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Hh(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ne=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<un||e.mode>Fa?1:0},Va=t=>{if(ne(t))return Tt;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=un,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Fh),e.distcode=e.distdyn=new Int32Array(Vh),e.sane=1,e.back=-1,te},Ba=t=>{if(ne(t))return Tt;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Va(t)},Ca=(t,e)=>{let n;if(ne(t))return Tt;const r=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Tt:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,Ba(t))},Ha=(t,e)=>{if(!t)return Tt;const n=new Hh;t.state=n,n.strm=t,n.window=null,n.mode=un;const r=Ca(t,e);return r!==te&&(t.state=null),r},zh=t=>Ha(t,Ch);let bi=!0,$n,An;const Uh=t=>{if(bi){$n=new Int32Array(512),An=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(we(Ma,t.lens,0,288,$n,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;we(Ia,t.lens,0,32,An,0,t.work,{bits:5}),bi=!1}t.lencode=$n,t.lenbits=9,t.distcode=An,t.distbits=5},za=(t,e,n,r)=>{let i;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(e.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(e.subarray(n-r,n-r+i),a.wnext),r-=i,r?(a.window.set(e.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},Ph=(t,e)=>{let n,r,i,a,s,o,c,l,f,d,h,u,w,T,k=0,$,g,_,m,x,A,y,E;const b=new Uint8Array(4);let v,p;const D=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ne(t)||!t.output||!t.input&&t.avail_in!==0)return Tt;n=t.state,n.mode===Bt&&(n.mode=vn),s=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,r=t.input,o=t.avail_in,l=n.hold,f=n.bits,d=o,h=c,E=te;t:for(;;)switch(n.mode){case un:if(n.wrap===0){n.mode=vn;break}for(;f<16;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(n.wrap&2&&l===35615){n.wbits===0&&(n.wbits=15),n.check=0,b[0]=l&255,b[1]=l>>>8&255,n.check=Dt(n.check,b,2,0),l=0,f=0,n.mode=ti;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((l&255)<<8)+(l>>8))%31){t.msg="incorrect header check",n.mode=j;break}if((l&15)!==jr){t.msg="unknown compression method",n.mode=j;break}if(l>>>=4,f-=4,y=(l&15)+8,n.wbits===0&&(n.wbits=y),y>15||y>n.wbits){t.msg="invalid window size",n.mode=j;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=l&512?li:Bt,l=0,f=0;break;case ti:for(;f<16;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(n.flags=l,(n.flags&255)!==jr){t.msg="unknown compression method",n.mode=j;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=j;break}n.head&&(n.head.text=l>>8&1),n.flags&512&&n.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,n.check=Dt(n.check,b,2,0)),l=0,f=0,n.mode=ei;case ei:for(;f<32;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.head&&(n.head.time=l),n.flags&512&&n.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,b[2]=l>>>16&255,b[3]=l>>>24&255,n.check=Dt(n.check,b,4,0)),l=0,f=0,n.mode=ni;case ni:for(;f<16;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.head&&(n.head.xflags=l&255,n.head.os=l>>8),n.flags&512&&n.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,n.check=Dt(n.check,b,2,0)),l=0,f=0,n.mode=ri;case ri:if(n.flags&1024){for(;f<16;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.length=l,n.head&&(n.head.extra_len=l),n.flags&512&&n.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,n.check=Dt(n.check,b,2,0)),l=0,f=0}else n.head&&(n.head.extra=null);n.mode=ii;case ii:if(n.flags&1024&&(u=n.length,u>o&&(u=o),u&&(n.head&&(y=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+u),y)),n.flags&512&&n.wrap&4&&(n.check=Dt(n.check,r,u,a)),o-=u,a+=u,n.length-=u),n.length))break t;n.length=0,n.mode=ai;case ai:if(n.flags&2048){if(o===0)break t;u=0;do y=r[a+u++],n.head&&y&&n.length<65536&&(n.head.name+=String.fromCharCode(y));while(y&&u<o);if(n.flags&512&&n.wrap&4&&(n.check=Dt(n.check,r,u,a)),o-=u,a+=u,y)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=si;case si:if(n.flags&4096){if(o===0)break t;u=0;do y=r[a+u++],n.head&&y&&n.length<65536&&(n.head.comment+=String.fromCharCode(y));while(y&&u<o);if(n.flags&512&&n.wrap&4&&(n.check=Dt(n.check,r,u,a)),o-=u,a+=u,y)break t}else n.head&&(n.head.comment=null);n.mode=oi;case oi:if(n.flags&512){for(;f<16;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(n.wrap&4&&l!==(n.check&65535)){t.msg="header crc mismatch",n.mode=j;break}l=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=Bt;break;case li:for(;f<32;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}t.adler=n.check=vi(l),l=0,f=0,n.mode=an;case an:if(n.havedict===0)return t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,n.hold=l,n.bits=f,Oh;t.adler=n.check=1,n.mode=Bt;case Bt:if(e===Ih||e===Fe)break t;case vn:if(n.last){l>>>=f&7,f-=f&7,n.mode=kn;break}for(;f<3;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}switch(n.last=l&1,l>>>=1,f-=1,l&3){case 0:n.mode=ci;break;case 1:if(Uh(n),n.mode=Ve,e===Fe){l>>>=2,f-=2;break t}break;case 2:n.mode=ui;break;case 3:t.msg="invalid block type",n.mode=j}l>>>=2,f-=2;break;case ci:for(l>>>=f&7,f-=f&7;f<32;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if((l&65535)!==(l>>>16^65535)){t.msg="invalid stored block lengths",n.mode=j;break}if(n.length=l&65535,l=0,f=0,n.mode=bn,e===Fe)break t;case bn:n.mode=fi;case fi:if(u=n.length,u){if(u>o&&(u=o),u>c&&(u=c),u===0)break t;i.set(r.subarray(a,a+u),s),o-=u,a+=u,c-=u,s+=u,n.length-=u;break}n.mode=Bt;break;case ui:for(;f<14;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(n.nlen=(l&31)+257,l>>>=5,f-=5,n.ndist=(l&31)+1,l>>>=5,f-=5,n.ncode=(l&15)+4,l>>>=4,f-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=j;break}n.have=0,n.mode=hi;case hi:for(;n.have<n.ncode;){for(;f<3;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.lens[D[n.have++]]=l&7,l>>>=3,f-=3}for(;n.have<19;)n.lens[D[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,v={bits:n.lenbits},E=we(Mh,n.lens,0,19,n.lencode,0,n.work,v),n.lenbits=v.bits,E){t.msg="invalid code lengths set",n.mode=j;break}n.have=0,n.mode=di;case di:for(;n.have<n.nlen+n.ndist;){for(;k=n.lencode[l&(1<<n.lenbits)-1],$=k>>>24,g=k>>>16&255,_=k&65535,!($<=f);){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(_<16)l>>>=$,f-=$,n.lens[n.have++]=_;else{if(_===16){for(p=$+2;f<p;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(l>>>=$,f-=$,n.have===0){t.msg="invalid bit length repeat",n.mode=j;break}y=n.lens[n.have-1],u=3+(l&3),l>>>=2,f-=2}else if(_===17){for(p=$+3;f<p;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}l>>>=$,f-=$,y=0,u=3+(l&7),l>>>=3,f-=3}else{for(p=$+7;f<p;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}l>>>=$,f-=$,y=0,u=11+(l&127),l>>>=7,f-=7}if(n.have+u>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=j;break}for(;u--;)n.lens[n.have++]=y}}if(n.mode===j)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=j;break}if(n.lenbits=9,v={bits:n.lenbits},E=we(Ma,n.lens,0,n.nlen,n.lencode,0,n.work,v),n.lenbits=v.bits,E){t.msg="invalid literal/lengths set",n.mode=j;break}if(n.distbits=6,n.distcode=n.distdyn,v={bits:n.distbits},E=we(Ia,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,v),n.distbits=v.bits,E){t.msg="invalid distances set",n.mode=j;break}if(n.mode=Ve,e===Fe)break t;case Ve:n.mode=Be;case Be:if(o>=6&&c>=258){t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,n.hold=l,n.bits=f,Ah(t,h),s=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,r=t.input,o=t.avail_in,l=n.hold,f=n.bits,n.mode===Bt&&(n.back=-1);break}for(n.back=0;k=n.lencode[l&(1<<n.lenbits)-1],$=k>>>24,g=k>>>16&255,_=k&65535,!($<=f);){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(g&&!(g&240)){for(m=$,x=g,A=_;k=n.lencode[A+((l&(1<<m+x)-1)>>m)],$=k>>>24,g=k>>>16&255,_=k&65535,!(m+$<=f);){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}l>>>=m,f-=m,n.back+=m}if(l>>>=$,f-=$,n.back+=$,n.length=_,g===0){n.mode=wi;break}if(g&32){n.back=-1,n.mode=Bt;break}if(g&64){t.msg="invalid literal/length code",n.mode=j;break}n.extra=g&15,n.mode=pi;case pi:if(n.extra){for(p=n.extra;f<p;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=mi;case mi:for(;k=n.distcode[l&(1<<n.distbits)-1],$=k>>>24,g=k>>>16&255,_=k&65535,!($<=f);){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(!(g&240)){for(m=$,x=g,A=_;k=n.distcode[A+((l&(1<<m+x)-1)>>m)],$=k>>>24,g=k>>>16&255,_=k&65535,!(m+$<=f);){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}l>>>=m,f-=m,n.back+=m}if(l>>>=$,f-=$,n.back+=$,g&64){t.msg="invalid distance code",n.mode=j;break}n.offset=_,n.extra=g&15,n.mode=gi;case gi:if(n.extra){for(p=n.extra;f<p;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=j;break}n.mode=_i;case _i:if(c===0)break t;if(u=h-c,n.offset>u){if(u=n.offset-u,u>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=j;break}u>n.wnext?(u-=n.wnext,w=n.wsize-u):w=n.wnext-u,u>n.length&&(u=n.length),T=n.window}else T=i,w=s-n.offset,u=n.length;u>c&&(u=c),c-=u,n.length-=u;do i[s++]=T[w++];while(--u);n.length===0&&(n.mode=Be);break;case wi:if(c===0)break t;i[s++]=n.length,c--,n.mode=Be;break;case kn:if(n.wrap){for(;f<32;){if(o===0)break t;o--,l|=r[a++]<<f,f+=8}if(h-=c,t.total_out+=h,n.total+=h,n.wrap&4&&h&&(t.adler=n.check=n.flags?Dt(n.check,i,h,s-h):Wn(n.check,i,h,s-h)),h=c,n.wrap&4&&(n.flags?l:vi(l))!==n.check){t.msg="incorrect data check",n.mode=j;break}l=0,f=0}n.mode=yi;case yi:if(n.wrap&&n.flags){for(;f<32;){if(o===0)break t;o--,l+=r[a++]<<f,f+=8}if(n.wrap&4&&l!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=j;break}l=0,f=0}n.mode=xi;case xi:E=Dh;break t;case j:E=Da;break t;case La:return Oa;case Fa:default:return Tt}return t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,n.hold=l,n.bits=f,(n.wsize||h!==t.avail_out&&n.mode<j&&(n.mode<kn||e!==Qr))&&za(t,t.output,t.next_out,h-t.avail_out),d-=t.avail_in,h-=t.avail_out,t.total_in+=d,t.total_out+=h,n.total+=h,n.wrap&4&&h&&(t.adler=n.check=n.flags?Dt(n.check,i,h,t.next_out-h):Wn(n.check,i,h,t.next_out-h)),t.data_type=n.bits+(n.last?64:0)+(n.mode===Bt?128:0)+(n.mode===Ve||n.mode===bn?256:0),(d===0&&h===0||e===Qr)&&E===te&&(E=Lh),E},qh=t=>{if(ne(t))return Tt;let e=t.state;return e.window&&(e.window=null),t.state=null,te},Gh=(t,e)=>{if(ne(t))return Tt;const n=t.state;return n.wrap&2?(n.head=e,e.done=!1,te):Tt},Wh=(t,e)=>{const n=e.length;let r,i,a;return ne(t)||(r=t.state,r.wrap!==0&&r.mode!==an)?Tt:r.mode===an&&(i=1,i=Wn(i,e,n,0),i!==r.check)?Da:(a=za(t,e,n,n),a?(r.mode=La,Oa):(r.havedict=1,te))};var Zh=Ba,Xh=Ca,Yh=Va,Kh=zh,Jh=Ha,Qh=Ph,jh=qh,t0=Gh,e0=Wh,n0="pako inflate (from Nodeca project)",Ct={inflateReset:Zh,inflateReset2:Xh,inflateResetKeep:Yh,inflateInit:Kh,inflateInit2:Jh,inflate:Qh,inflateEnd:jh,inflateGetHeader:t0,inflateSetDictionary:e0,inflateInfo:n0};function r0(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var i0=r0;const Ua=Object.prototype.toString,{Z_NO_FLUSH:a0,Z_FINISH:s0,Z_OK:$e,Z_STREAM_END:En,Z_NEED_DICT:Tn,Z_STREAM_ERROR:o0,Z_DATA_ERROR:ki,Z_MEM_ERROR:l0}=Ra;function hn(t){this.options=Sa.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kh,this.strm.avail_out=0;let n=Ct.inflateInit2(this.strm,e.windowBits);if(n!==$e)throw new Error(Zn[n]);if(this.header=new i0,Ct.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Xn.string2buf(e.dictionary):Ua.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Ct.inflateSetDictionary(this.strm,e.dictionary),n!==$e)))throw new Error(Zn[n])}hn.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?s0:a0,Ua.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=Ct.inflate(n,s),a===Tn&&i&&(a=Ct.inflateSetDictionary(n,i),a===$e?a=Ct.inflate(n,s):a===ki&&(a=Tn));n.avail_in>0&&a===En&&n.state.wrap>0&&t[n.next_in]!==0;)Ct.inflateReset(n),a=Ct.inflate(n,s);switch(a){case o0:case ki:case Tn:case l0:return this.onEnd(a),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(n.avail_out===0||a===En))if(this.options.to==="string"){let c=Xn.utf8border(n.output,n.next_out),l=n.next_out-c,f=Xn.buf2string(n.output,c);n.next_out=l,n.avail_out=r-l,l&&n.output.set(n.output.subarray(c,c+l),0),this.onData(f)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(a===$e&&o===0)){if(a===En)return a=Ct.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};hn.prototype.onData=function(t){this.chunks.push(t)};hn.prototype.onEnd=function(t){t===$e&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Sa.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function c0(t,e){const n=new hn(e);if(n.push(t),n.err)throw n.msg||Zn[n.err];return n.result}var f0=c0,u0={inflate:f0};const{inflate:h0}=u0;var d0=h0;const p0={refName:"seq_id"},m0={seq_id:"refName"};class sn{constructor(e,n,r){this.ncFeature=e,this.uniqueId=r||e.id(),this.parentHandle=n}jb2TagToJb1Tag(e){return(p0[e]||e).toLowerCase()}jb1TagToJb2Tag(e){const n=e.toLowerCase();return m0[n]||n}get(e){const n=this.ncFeature.get(this.jb2TagToJb1Tag(e));return n&&e==="subfeatures"?n.map(r=>new sn(r,this)):n}tags(){return this.ncFeature.tags().map(e=>this.jb1TagToJb2Tag(e))}id(){return this.uniqueId}parent(){return this.parentHandle}children(){return this.get("subfeatures")}toJSON(){const e={uniqueId:this.id(),subfeatures:[]};return this.ncFeature.tags().forEach(n=>{const r=this.jb1TagToJb2Tag(n),i=this.ncFeature.get(n);r==="subfeatures"?e.children=(i||[]).map(a=>new sn(a,this).toJSON()):e[r]=i}),{...e,fmin:e.start,fmax:e.end,seqId:e.refName}}}function g0(t){return t[0]===31&&t[1]===139&&t[2]===8}async function _0(t){const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status} fetching ${t}`);const n=await e.arrayBuffer();return g0(new Uint8Array(n))?d0(n):n}async function w0({urlTemplate:t,baseUrl:e,chromosome:n,start:r,end:i}){const a=new ju({urlTemplate:t,baseUrl:e,readFile:_0}),s=[];for await(const o of a.getFeatures({refName:n,start:r,end:i}))s.push(new sn(o).toJSON());return s}ee.prototype.first=function(){return K(this.nodes()[0])};ee.prototype.last=function(){return K(this.nodes()[this.size()-1])};class he{constructor(e,n,r,i){this.height=i,this.width=r,this.config=e,this.svg_target=n,this.viewer=this._initViewer(n),this.draw()}generateLegend(){return of()}get tracks(){return this.config.tracks??[]}get genome(){return this.config.genome}closeModal(){for(const e of document.getElementsByClassName("gfc-tooltip"))e.style.visibility="hidden"}setSelectedAlleles(e,n){const r=K(n);r.selectAll(".highlight").remove(),r.selectAll(".variant-deletion,.variant-SNV,.variant-insertion,.variant-delins").filter(i=>i.selected).style("stroke",null).datum(i=>(i.selected="false",i)),sa(e,r)}_initViewer(e){K(e).selectAll("*").remove();const n=K(e),i=`${e.replace("#","")} main-view`;if(this.config.locale==="global"){const a={top:8,right:30,bottom:30,left:40};n.attr("width",this.width).attr("height",this.height).append("g").attr("transform",`translate(${a.left},${a.top})`).attr("class",i),this.width=this.width-a.left-a.right,this.height=this.height-a.top-a.bottom}else{const a={top:10,bottom:10};n.attr("width",this.width).attr("height",this.height).append("g").attr("class",i),this.height=this.height-a.top-a.bottom}return K(`${e} .main-view`)}getTracks(e){return e?this.tracks[0]:this.tracks}draw(){const e=this.width,n=this.config.transcriptTypes??["mRNA","ncRNA","piRNA","lincRNA","miRNA","pre_miRNA","snoRNA","lnc_RNA","tRNA","snRNA","rRNA","ARS","antisense_RNA","C_gene_segment","V_gene_segment","pseudogene_attribute","snoRNA_gene","polypeptide_region","mature_protein_region"],r=this.config.variantTypes??["point_mutation","MNV","Deletion","Insertion","Delins"],i=this.config.binRatio??.01,a=this.config,s=this._configureRange(a.region.start,a.region.end,e),o=s.range,c=a.region.chromosome,l=a.variantFilter??[],f=a.isoformFilter??[],d=a.htpVariant??"",h=s.start,u=s.end;new hf({viewer:this.viewer,track:{chromosome:c,start:h,end:u,range:s.range},height:this.height,width:e}).DrawOverviewTrack();let k=100;const $=!0,{viewer:g,genome:_,height:m,tracks:x}=this,A={start:h,end:u,chromosome:c};Promise.all(x.map(async y=>{const{variantData:E,trackData:b}=y;if(y.type===O.ISOFORM_AND_VARIANT){const v=new cf({region:A,viewer:g,height:m,width:e,transcriptTypes:n,variantTypes:r,showVariantLabel:$,trackData:b,variantData:E,variantFilter:l,binRatio:i,isoformFilter:f});k+=v.DrawTrack()}else if(y.type===O.ISOFORM_EMBEDDED_VARIANT){const v=new ff({viewer:g,height:m,width:e,transcriptTypes:n,variantData:E,trackData:b,variantTypes:r,showVariantLabel:$,variantFilter:l});k+=v.DrawTrack()}else if(y.type===O.ISOFORM){const v=new uf({region:A,viewer:g,height:m,width:e,genome:_,trackData:b,transcriptTypes:n,htpVariant:d});k+=v.DrawTrack()}else if(y.type===O.VARIANT){const v=new Fu({region:A,viewer:g,range:o,height:m,width:e});await v.getTrackData(),v.DrawTrack()}else if(y.type===O.VARIANT_GLOBAL){const v=new Vu({region:A,viewer:g,track:{...y,range:o},height:m,width:e});await v.getTrackData(),v.DrawTrack()}else console.error(`TrackType not found for ${y.id}...`,y.type);K(this.svg_target).attr("height",k)})).catch(y=>{console.error(y)})}_configureRange(e,n,r){let i=null;const a=17;let s=0,o=[0,0];if(e===n){i=300,s=a*i,e=e-i/2-1,n=n+i/2;const c=K("#clip-rect").node().getBoundingClientRect().width/2+100;o=[c-s/2,c+s/2]}else return{range:[0,r],start:e,end:n};return{range:o,start:e,end:n}}}function dn(t){const[e,n]=t.split(":"),[r,i]=n.split("..");return{chromosome:e,start:+r,end:+i}}async function Yn({chromosome:t,start:e,end:n,genome:r,baseUrl:i,track:a,extra:s=".json?ignoreCache=true&flatten=false"}){const o=`${t}:${e}..${n}`,c=`${i}/${encodeURI(r)}/${encodeURI(a)}/${encodeURIComponent(o)}${s}`,l=await fetch(c);if(!l.ok)throw new Error(`HTTP ${l.status} fetching ${c}`);return l.json()}const Kn="https://www.alliancegenome.org/apollo";N0();T0();E0();A0();k0();$0();b0();y0();x0();v0();function pn(){return["mRNA","ncRNA","piRNA","lincRNA","miRNA","pre_miRNA","snoRNA","lnc_RNA","tRNA","snRNA","rRNA","ARS","antisense_RNA","C_gene_segment","V_gene_segment","pseudogene_attribute","snoRNA_gene","polypeptide_region","mature_protein_region"]}function y0(){S0("NC_045512.2:17894..28259","SARS-CoV-2","covidExample1",O.ISOFORM,!1)}function x0(){R0("NC_045512.2:17894..28259","SARS-CoV-2","nclistviewer",O.ISOFORM,!1)}function v0(){H("5:120503475..120682281","rat","viewerActnFly",O.ISOFORM_AND_VARIANT,!1,[],[]),on("17:43044295..43170245","human","viewerHumanVariant",O.ISOFORM,!1),H("9:42732992..42873700","zebrafish","viewerHighlightExample",O.ISOFORM_AND_VARIANT,!1),H("chrIV:1276654..1277169","yeast","viewerSGDexample",O.ISOFORM_AND_VARIANT,!1)}function b0(){H("2L:130639..135911","fly","viewerFlyExample1",O.ISOFORM_EMBEDDED_VARIANT,!0),H("2R:23974973..23989002","fly","viewerFlyExample3",O.ISOFORM_EMBEDDED_VARIANT,!0,["NT_033778.4:g.23975146T>C"]),H("2R:23974973..23989002","fly","viewerFlyExample2",O.ISOFORM_EMBEDDED_VARIANT,!0),H("2L:130639..135911","fly","viewerFlyExample1NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1),H("2R:23974973..23989002","fly","viewerFlyExample3NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1,["NT_033778.4:g.23975146T>C"]),H("2R:23974973..23989002","fly","viewerFlyExample2NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1),H("2R:23974973..23989002","fly","viewerFlyExample2NoLabelAnd",O.ISOFORM_AND_VARIANT,!1),H("3R:22693140..22699809","fly","viewerFlyExample3",O.ISOFORM_AND_VARIANT,!1),H("2R:23974972..23989001","fly","viewerFlyExample4",O.ISOFORM_AND_VARIANT,!1),H("3R:22693140..22699809","fly","viewerFlyExample5",O.ISOFORM_AND_VARIANT,!1,["FB:FBal0265700","FB:FBal0265699"]),H("2R:18614210..18615018","fly","viewerFlyExample6",O.ISOFORM_AND_VARIANT,!1,["FB:FBal0325512"]),H("X:2023822..2043557","fly","viewerFlyExample7",O.ISOFORM_AND_VARIANT,!1,["FB:FBal0212726"])}function k0(){H("10:94485648..94489071","rat","networkExampleRat1",O.ISOFORM_EMBEDDED_VARIANT,!0),H("10:94485648..94489071","rat","networkExampleRat1And",O.ISOFORM_AND_VARIANT,!0),H("1:34987290..35280466","rat","viewerRatExample1",O.ISOFORM_EMBEDDED_VARIANT,!0),H("1:34987290..35280466","rat","viewerRatExample1NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1)}function $0(){H("18:11035719..11058885","mouse","viewerMouseExample6",O.ISOFORM_AND_VARIANT,!1),on("18:11042037..11052567","mouse","viewerMouseExample5",O.ISOFORM,!1),H("17:46007760..46041588","mouse","viewerMouseExample4",O.ISOFORM_AND_VARIANT,!1),H("11:69550420..69563869","mouse","viewerMouseExample3",O.ISOFORM_AND_VARIANT,!1),H("3:115707662..115717830","mouse","viewerMouseExample2",O.ISOFORM_AND_VARIANT,!1),H("6:113619452..113636198","mouse","viewerMouseExample1",O.ISOFORM_EMBEDDED_VARIANT,!0),H("6:113619452..113636198","mouse","viewerMouseExample1NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1),H("6:113619452..113636198","mouse","viewerMouseExample1NoLabelAnd",O.ISOFORM_AND_VARIANT,!1)}function A0(){H("14:5383966..5390885","zebrafish","viewerFishLbx2",O.ISOFORM_EMBEDDED_VARIANT,!0),H("8:40452405..40469627","zebrafish","viewerFishMyl7",O.ISOFORM_EMBEDDED_VARIANT,!0),H("14:5383966..5390885","zebrafish","viewerFishLbx2NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1),H("14:5383966..5390885","zebrafish","viewerFishLbx2NoLabelAnd",O.ISOFORM_AND_VARIANT,!1),H("14:5383966..5390885","zebrafish","viewerFishLbx2NoLabelAndNameOnly",O.ISOFORM_AND_VARIANT,!1,["NC_007125.7:g.5388210A>T"]),H("14:5383966..5390885","zebrafish","viewerFishLbx2NoLabelAndSymbolOnly",O.ISOFORM_AND_VARIANT,!1,["hu3336"]),H("8:40452405..40469627","zebrafish","viewerFishMyl7NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1)}function E0(){H("V:7106..57424","worm","viewerWormEgl8",O.ISOFORM_EMBEDDED_VARIANT,!0),H("V:7106..57424","worm","viewerWormEgl8NoLabel",O.ISOFORM_EMBEDDED_VARIANT,!1),H("V:7114..57432","worm","networkExampleWorm1",O.ISOFORM_EMBEDDED_VARIANT,!0),H("V:7114..57432","worm","networkExampleWorm1And",O.ISOFORM_AND_VARIANT,!0)}function T0(){on("chrIV:1276345..1277478","yeast","yeastExampleIsoformOnly",O.ISOFORM,!0),on("25:15029041..15049781","zebrafish","zebrafishExampleIsoformOnly",O.ISOFORM,!0)}async function H(t,e,n,r,i,a,s){try{const o=dn(t),c=await Yn({...o,genome:e,track:"All Genes",baseUrl:`${Kn}/track/`}),l=await Yn({...o,genome:e,track:"Variants",baseUrl:`${Kn}/vcf`}),f=new he({locale:"global",region:o,showVariantLabel:i,transcriptTypes:pn(),isoformFilter:s??[],variantFilter:a??[],genome:e,tracks:[{id:"12",type:r,trackData:c,variantData:l}]},`#${n}`,900,500),d=document.getElementById(`${n}CloseButton`);d&&d.addEventListener("click",()=>{f.closeModal()});const h=document.getElementById(`${n}LegendTarget`);h&&(h.innerHTML=f.generateLegend()),n==="networkExampleWorm1And"&&(document.getElementById("wormbutton").addEventListener("click",function(){f.setSelectedAlleles(["WB:WBVar00089535","WB:WBVar02125540","WB:WBVar00242477"],"#networkExampleWorm1And")}),document.getElementById("clrbutton").addEventListener("click",function(){f.setSelectedAlleles([],"#networkExampleWorm1And")})),n==="viewerFlyExample2NoLabelAnd"&&(document.getElementById("flybutton").addEventListener("click",function(){f.setSelectedAlleles(["FB:FBal0242675","FB:FBal0302371","FB:FBal0012433"],"#viewerFlyExample2NoLabelAnd")}),document.getElementById("clrbuttonfly").addEventListener("click",function(){f.setSelectedAlleles([],"#viewerFlyExample2NoLabelAnd")})),n==="viewerHighlightExample"&&(document.getElementById("mausbutton").addEventListener("click",function(){f.setSelectedAlleles(["ZFIN:ZDB-ALT-130411-164"],"#viewerHighlightExample")}),document.getElementById("clrbuttonmaus").addEventListener("click",function(){f.setSelectedAlleles([],"#viewerHighlightExample")}))}catch(o){console.error(o)}}async function on(t,e,n,r,i,a){try{const s=dn(t),o=await Yn({...s,genome:e,track:"All Genes",baseUrl:`${Kn}/track/`});new he({locale:"global",region:s,transcriptTypes:pn(),showVariantLabel:i,variantFilter:a??[],genome:e,tracks:[{id:"12",type:r,trackData:o}]},`#${n}`,900,500)}catch(s){console.error(s)}}async function R0(t,e,n,r,i,a){const s=dn(t),o=await w0({...s,baseUrl:"https://s3.amazonaws.com/agrjbrowse/docker/3.2.0/SARS-CoV-2/tracks/",urlTemplate:"All%20Genes/NC_045512.2/trackData.jsonz"});new he({locale:"global",region:s,genome:e,transcriptTypes:pn(),showVariantLabel:i,variantFilter:[],tracks:[{id:"12",type:r,trackData:o}]},`#${n}`,900,500)}function S0(t,e,n,r,i,a){new he({locale:"global",region:dn(t),genome:e,transcriptTypes:pn(),showVariantLabel:i,variantFilter:[],tracks:[{id:"12",type:r}]},`#${n}`,900,500)}function N0(){new he({locale:"global",genome:"",region:{chromosome:"5",start:75574916,end:75656722},tracks:[{id:"2",type:O.VARIANT_GLOBAL},{id:"1",type:O.ISOFORM}]},"#viewer1",700,null),new he({locale:"global",region:{chromosome:"2L",start:19400752,end:19426596},genome:"fly",tracks:[{id:"1",type:O.ISOFORM}]},"#viewer2",700,null)}
